<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>From CIP and family to LT-FH++ input • LTFHPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="From CIP and family to LT-FH++ input">
<meta property="og:description" content="LTFHPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FromCIPFamilyToLTFHPlusInput.html">From CIP and family to LT-FH++ input</a>
    </li>
    <li>
      <a href="../articles/FromTrioToFamilies.html">From trio information to full families</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusGraphExample.html">LT-FH++ Graph Example</a>
    </li>
    <li>
      <a href="../articles/inputFormatExample.html">How the covariance is constructed</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>From CIP and family to LT-FH++ input</h1>
                        <h4 data-toc-skip class="author">Emil M.
Pedersen</h4>
            
            <h4 data-toc-skip class="date">2024-01-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/vignettes/FromCIPFamilyToLTFHPlusInput.Rmd" class="external-link"><code>vignettes/FromCIPFamilyToLTFHPlusInput.Rmd</code></a></small>
      <div class="hidden name"><code>FromCIPFamilyToLTFHPlusInput.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EmilMiP/LTFHPlus" class="external-link">LTFHPlus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="dummy-input">Dummy input<a class="anchor" aria-label="anchor" href="#dummy-input"></a>
</h3>
<p>Here we will simply simulate a potential input format. We create
<code>tbæ</code>, which contains information on each person to attach
thresholds to. It should contain each family member along with the
needed information. Here, we simply use the proband with no family
members. Next, we create <code>CIP</code>, which contains the cumulative
incidence proportions. The CIP is stratified by birth year and sex for
illustrative purposes. If users only have CIPs stratified by sex, it
would simply have one fewer columns. <strong>Please note that all values
shown here are only for illustrative purposes.</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_sim</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">tbl</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  fam_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"fam"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_sim</span><span class="op">)</span>,</span>
<span>  pid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sim</span>,</span>
<span>  role <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="va">n_sim</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, size <span class="op">=</span> <span class="va">n_sim</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">n_sim</span>, x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">n_sim</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">90</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  birth_year <span class="op">=</span> <span class="fl">2023</span> <span class="op">-</span> <span class="va">age</span>,</span>
<span>  aoo <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_dbl</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">status</span>, .y <span class="op">=</span> <span class="va">age</span>, .f <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.x</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">.y</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">##    fam_id   pid role    sex status   age birth_year   aoo</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> fam1       1 o         1      1    67       <span style="text-decoration: underline;">1</span>956     5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> fam2       2 o         1      1    35       <span style="text-decoration: underline;">1</span>988    34</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> fam3       3 o         1      1    54       <span style="text-decoration: underline;">1</span>969    23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> fam4       4 o         1      1    55       <span style="text-decoration: underline;">1</span>968    10</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> fam5       5 o         1      0     6       <span style="text-decoration: underline;">2</span>017    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> fam6       6 o         0      1    89       <span style="text-decoration: underline;">1</span>934    27</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> fam7       7 o         1      0    79       <span style="text-decoration: underline;">1</span>944    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> fam8       8 o         0      0    69       <span style="text-decoration: underline;">1</span>954    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> fam9       9 o         1      1    32       <span style="text-decoration: underline;">1</span>991    21</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> fam10     10 o         0      1    20       <span style="text-decoration: underline;">2</span>003     9</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### THIS IS DUMMY CIP. DO NOT USE FOR REAL-WORLD DATA USE ####</span></span>
<span><span class="va">CIP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                       birth_year <span class="op">=</span> <span class="fl">1900</span><span class="op">:</span><span class="fl">2024</span>,</span>
<span>                       sex <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">birth_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cip <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 25,000 × 4</span></span></span>
<span><span class="co">##      age birth_year   sex   cip</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1       <span style="text-decoration: underline;">1</span>900     0 0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     2       <span style="text-decoration: underline;">1</span>900     0 0.001</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     3       <span style="text-decoration: underline;">1</span>900     0 0.002</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     4       <span style="text-decoration: underline;">1</span>900     0 0.003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     5       <span style="text-decoration: underline;">1</span>900     0 0.004</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     6       <span style="text-decoration: underline;">1</span>900     0 0.005</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     7       <span style="text-decoration: underline;">1</span>900     0 0.006</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     8       <span style="text-decoration: underline;">1</span>900     0 0.007</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     9       <span style="text-decoration: underline;">1</span>900     0 0.008</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    10       <span style="text-decoration: underline;">1</span>900     0 0.009</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 24,990 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### THIS IS DUMMY CIP. DO NOT USE FOR REAL-WORLD DATA USE ####</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="preparing-input">Preparing input<a class="anchor" aria-label="anchor" href="#preparing-input"></a>
</h3>
<p>Assigning thresholds to each person in <code>tbl</code> can now be
done with the function <code>prepare_LTFHPlus_input</code>. The
thresholds can be assigned in two ways. The first is matching directly
on the combinations of birth year, sex, and age of each person to the
combinations that are present in the <code>CIP</code> object. The second
uses interpolation to predict the CIP value between the observed
combinations of birth year, sex, and age that is present in the CIP
object. Currently, only interpolation with
<strong><em>xgboost</em></strong> package is supported. The
interpolation can be useful, since real-world data often lead to ages or
age of onsets that can be expressed as decimals and rounding may lead to
large jumps in CIP values. The outputs below can be subset such that
only the required information is left. For direct input into
<code><a href="../reference/estimate_liability.html">estimate_liability()</a></code>, only the family and personal id
columns are needed as well as role (if the graph input is not used) and
the lower and upper columns.</p>
<div class="section level4">
<h4 id="no-interpolation">No interpolation<a class="anchor" aria-label="anchor" href="#no-interpolation"></a>
</h4>
<p>Without using interpolation, meaning we match on the combinations of
birth year, sex and age that are present in both the <code>tbl</code>
and <code>CIP</code> objects. The thresholds can then be assigned in the
following way:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl2</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_LTFHPlus_input.html">prepare_LTFHPlus_input</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">tbl</span>,</span>
<span>                              CIP <span class="op">=</span> <span class="va">CIP</span>, </span>
<span>                              age_col <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>                              aoo_col <span class="op">=</span> <span class="st">"aoo"</span>,</span>
<span>                              CIP_merge_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"birth_year"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>                              CIP_cip_col <span class="op">=</span> <span class="st">"cip"</span>,</span>
<span>                              status_col <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>                              use_fixed_case_thr <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                              fam_id_col <span class="op">=</span> <span class="st">"fam_id"</span>,</span>
<span>                              personal_id_col <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                              interpolation <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                              min_CIP_value <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span></span>
<span><span class="va">tbl2</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 12</span></span></span>
<span><span class="co">##    fam_id   pid role    sex status   age birth_year   aoo   cip   thr   lower</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> fam1       1 o         1      1     5       <span style="text-decoration: underline;">1</span>956     5 0.004  2.65    2.65</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> fam2       2 o         1      1    34       <span style="text-decoration: underline;">1</span>988    34 0.033  1.84    1.84</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> fam3       3 o         1      1    23       <span style="text-decoration: underline;">1</span>969    23 0.022  2.01    2.01</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> fam4       4 o         1      1    10       <span style="text-decoration: underline;">1</span>968    10 0.009  2.37    2.37</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> fam5       5 o         1      0     6       <span style="text-decoration: underline;">2</span>017    <span style="color: #BB0000;">NA</span> 0.005  2.58 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> fam6       6 o         0      1    27       <span style="text-decoration: underline;">1</span>934    27 0.026  1.94    1.94</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> fam7       7 o         1      0    79       <span style="text-decoration: underline;">1</span>944    <span style="color: #BB0000;">NA</span> 0.078  1.42 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> fam8       8 o         0      0    69       <span style="text-decoration: underline;">1</span>954    <span style="color: #BB0000;">NA</span> 0.068  1.49 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> fam9       9 o         1      1    21       <span style="text-decoration: underline;">1</span>991    21 0.02   2.05    2.05</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> fam10     10 o         0      1     9       <span style="text-decoration: underline;">2</span>003     9 0.008  2.41    2.41</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: upper &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="interpolation-with-xgboost">Interpolation with Xgboost<a class="anchor" aria-label="anchor" href="#interpolation-with-xgboost"></a>
</h4>
<p>If decimal ages and ages of onset are present, then we can
interpolate the cip values with the xgboost package. The input does not
change, except for <code>interpolate = "xgboost"</code>. The current
input data does not contain decimal values, but for illustrative
purposes, we will use it as-is. Parameters can be passed to xgboost
through the <code>bst.params</code> variable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl2_xgb</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_LTFHPlus_input.html">prepare_LTFHPlus_input</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">tbl</span>,</span>
<span>                                 CIP <span class="op">=</span> <span class="va">CIP</span>, </span>
<span>                                 age_col <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>                                 aoo_col <span class="op">=</span> <span class="st">"aoo"</span>,</span>
<span>                                 CIP_merge_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"birth_year"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>                                 CIP_cip_col <span class="op">=</span> <span class="st">"cip"</span>,</span>
<span>                                 status_col <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>                                 use_fixed_case_thr <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                                 fam_id_col <span class="op">=</span> <span class="st">"fam_id"</span>,</span>
<span>                                 personal_id_col <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                                 interpolation <span class="op">=</span> <span class="st">"xgboost"</span>, </span>
<span>                                 xgboost_itr <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                                 min_CIP_value <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  train-rmse:0.040135 </span></span>
<span><span class="co">## [2]  train-rmse:0.028111 </span></span>
<span><span class="co">## [3]  train-rmse:0.019688 </span></span>
<span><span class="co">## [4]  train-rmse:0.013790 </span></span>
<span><span class="co">## [5]  train-rmse:0.009659 </span></span>
<span><span class="co">## [6]  train-rmse:0.006766 </span></span>
<span><span class="co">## [7]  train-rmse:0.004740 </span></span>
<span><span class="co">## [8]  train-rmse:0.003321 </span></span>
<span><span class="co">## [9]  train-rmse:0.002328 </span></span>
<span><span class="co">## [10] train-rmse:0.001632 </span></span>
<span><span class="co">## [11] train-rmse:0.001144 </span></span>
<span><span class="co">## [12] train-rmse:0.000802 </span></span>
<span><span class="co">## [13] train-rmse:0.000563 </span></span>
<span><span class="co">## [14] train-rmse:0.000395 </span></span>
<span><span class="co">## [15] train-rmse:0.000278 </span></span>
<span><span class="co">## [16] train-rmse:0.000196 </span></span>
<span><span class="co">## [17] train-rmse:0.000139 </span></span>
<span><span class="co">## [18] train-rmse:0.000101 </span></span>
<span><span class="co">## [19] train-rmse:0.000075 </span></span>
<span><span class="co">## [20] train-rmse:0.000058 </span></span>
<span><span class="co">## [21] train-rmse:0.000047 </span></span>
<span><span class="co">## [22] train-rmse:0.000041 </span></span>
<span><span class="co">## [23] train-rmse:0.000037 </span></span>
<span><span class="co">## [24] train-rmse:0.000035 </span></span>
<span><span class="co">## [25] train-rmse:0.000034 </span></span>
<span><span class="co">## [26] train-rmse:0.000034 </span></span>
<span><span class="co">## [27] train-rmse:0.000034 </span></span>
<span><span class="co">## [28] train-rmse:0.000034 </span></span>
<span><span class="co">## [29] train-rmse:0.000034 </span></span>
<span><span class="co">## [30] train-rmse:0.000034</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl2_xgb</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 13</span></span></span>
<span><span class="co">##    fam_id   pid role    sex status   age birth_year   aoo cip_pred event_age</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> fam1       1 o         1      1    67       <span style="text-decoration: underline;">1</span>956     5  0.004<span style="text-decoration: underline;">01</span>         5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> fam5       5 o         1      0     6       <span style="text-decoration: underline;">2</span>017    <span style="color: #BB0000;">NA</span>  0.005<span style="text-decoration: underline;">02</span>         6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> fam10     10 o         0      1    20       <span style="text-decoration: underline;">2</span>003     9  0.008<span style="text-decoration: underline;">01</span>         9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> fam4       4 o         1      1    55       <span style="text-decoration: underline;">1</span>968    10  0.009<span style="text-decoration: underline;">00</span>        10</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> fam9       9 o         1      1    32       <span style="text-decoration: underline;">1</span>991    21  0.020<span style="text-decoration: underline;">0</span>         21</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> fam3       3 o         1      1    54       <span style="text-decoration: underline;">1</span>969    23  0.022<span style="text-decoration: underline;">0</span>         23</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> fam6       6 o         0      1    89       <span style="text-decoration: underline;">1</span>934    27  0.026<span style="text-decoration: underline;">0</span>         27</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> fam2       2 o         1      1    35       <span style="text-decoration: underline;">1</span>988    34  0.033<span style="text-decoration: underline;">0</span>         34</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> fam8       8 o         0      0    69       <span style="text-decoration: underline;">1</span>954    <span style="color: #BB0000;">NA</span>  0.068<span style="text-decoration: underline;">1</span>         69</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> fam7       7 o         1      0    79       <span style="text-decoration: underline;">1</span>944    <span style="color: #BB0000;">NA</span>  0.077<span style="text-decoration: underline;">9</span>         79</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: thr &lt;dbl&gt;, lower &lt;dbl&gt;, upper &lt;dbl&gt;</span></span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="estimating-liabilities">Estimating liabilities<a class="anchor" aria-label="anchor" href="#estimating-liabilities"></a>
</h3>
<p>From here, the above objects <code>tbl2</code> and
<code>tbl2_xgb</code> can be subset to the relevant columns and used in
<code><a href="../reference/estimate_liability.html">estimate_liability()</a></code>. See <strong><em>LT-FH++
Example</em></strong> for an example of this.</p>
<p>The objects can also be subset to contain just the family and
personal ID columns, as well as the lower and upper columns, and then
used as input in <code><a href="../reference/prepare_graph.html">prepare_graph()</a></code> to assign each individual
with the threshold information as attributes. See <strong><em>LT-FH++
Graph Example</em></strong> for details.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
