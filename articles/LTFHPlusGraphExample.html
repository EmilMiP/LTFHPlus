<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LT-FH++ Graph Example • LTFHPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="LT-FH++ Graph Example">
<meta property="og:description" content="LTFHPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FromCIPFamilyToLTFHPlusInput.html">From CIP and family to LT-FH++ input</a>
    </li>
    <li>
      <a href="../articles/FromTrioToFamilies.html">From trio information to full families</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusGraphExample.html">LT-FH++ Graph Example</a>
    </li>
    <li>
      <a href="../articles/inputFormatExample.html">How the covariance is constructed</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>LT-FH++ Graph Example</h1>
                        <h4 data-toc-skip class="author">Emil M.
Pedersen</h4>
            
            <h4 data-toc-skip class="date">2024-02-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/vignettes/LTFHPlusGraphExample.Rmd" class="external-link"><code>vignettes/LTFHPlusGraphExample.Rmd</code></a></small>
      <div class="hidden name"><code>LTFHPlusGraphExample.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EmilMiP/LTFHPlus" class="external-link">LTFHPlus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="automatic-family-construction">Automatic family construction<a class="anchor" aria-label="anchor" href="#automatic-family-construction"></a>
</h3>
<p>Manually constructing family history from registers can be tedious.
It can be easily done for first and second degree relatives, however, it
starts to become very difficult once further degrees of relatives needs
to be identified. Other R packages, such as <em>Kinship2</em> or
<em>FamAgg</em>, allows users to manipulate pedigrees and perform
certain actions and calculations on them, however, to the best of our
knowledge, they do not allow one to find all relatives of degree <span class="math inline">\(n\)</span> or closer of a given individual. This
particular problem is core to LT-FH++, as the family members of a
proband (often the genotyped individual) will need to be identified as
well as the family members’ mutual kinship coefficient for the
covariance matrix. With the introduction of the function
<code><a href="../reference/prepare_graph.html">prepare_graph()</a></code>, we have made it possible to automatically
construct families for a list of probands. Below, we will provide an
example of how the function can be used in connection with the
<code><a href="../reference/estimate_liability.html">estimate_liability()</a></code> function of the package. <em>All data
is simulated and should not be used as-is in any real-world
analysis.</em></p>
</div>
<div class="section level3">
<h3 id="constructing-the-population-pedigree">Constructing the population pedigree<a class="anchor" aria-label="anchor" href="#constructing-the-population-pedigree"></a>
</h3>
<p>The input is inspired by register information such as the trio
information provided by the danish CPR register. It usually follows the
format of having a column with the child’s ID (here simply
<code>id</code>), followed by columns for the mother’s and father’s ID
(here <code>momcol</code> and <code>dadcol</code>). Here, we provide an
illustrative example of how the register information may look. The names
used are representative of their relation to a proband named “pid”, with
“pgm” refering to paternal grandmother, “mgf” refering to maternal
grandfather, the “hs” prefix means half-sibling, the new parents of
half-siblings will appear with the “H” or “W” suffix for husband or
wife, cousins are prefaced with the first two letters of their parents,
etc..</p>
<p>Additionally, we will also need threshold information for the
phenotype(s) of interest. The information is baked into the graph object
as attributes, and retrieved as needed later by the
<code><a href="../reference/estimate_liability.html">estimate_liability()</a></code> function. It is possible to construct
the graph without this information and only construct the desired
families.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of register trio input</span></span>
<span><span class="va">family</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">id</span>, <span class="op">~</span><span class="va">momcol</span>, <span class="op">~</span><span class="va">dadcol</span>,</span>
<span>  <span class="st">"pid"</span>, <span class="st">"mom"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"sib"</span>, <span class="st">"mom"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"mhs"</span>, <span class="st">"mom"</span>, <span class="st">"dad2"</span>,</span>
<span>  <span class="st">"phs"</span>, <span class="st">"mom2"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"mom"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"dad"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"dad2"</span>, <span class="st">"pgm2"</span>, <span class="st">"pgf2"</span>,</span>
<span>  <span class="st">"paunt"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"pacousin"</span>, <span class="st">"paunt"</span>, <span class="st">"pauntH"</span>,</span>
<span>  <span class="st">"hspaunt"</span>, <span class="st">"pgm"</span>, <span class="st">"newpgf"</span>,</span>
<span>  <span class="st">"hspacousin"</span>, <span class="st">"hspaunt"</span>, <span class="st">"hspauntH"</span>,</span>
<span>  <span class="st">"puncle"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"pucousin"</span>, <span class="st">"puncleW"</span>, <span class="st">"puncle"</span>,</span>
<span>  <span class="st">"maunt"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"macousin"</span>, <span class="st">"maunt"</span>, <span class="st">"mauntH"</span>,</span>
<span>  <span class="st">"hsmuncle"</span>, <span class="st">"newmgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"hsmucousin"</span>, <span class="st">"hsmuncleW"</span>, <span class="st">"hsmuncle"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 17 × 3</span></span></span>
<span><span class="co">##    id         momcol    dadcol  </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> pid        mom       dad     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> sib        mom       dad     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> mhs        mom       dad2    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> phs        mom2      dad     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> mom        mgm       mgf     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> dad        pgm       pgf     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> dad2       pgm2      pgf2    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> paunt      pgm       pgf     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> pacousin   paunt     pauntH  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> hspaunt    pgm       newpgf  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> hspacousin hspaunt   hspauntH</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> puncle     pgm       pgf     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> pucousin   puncleW   puncle  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span> maunt      mgm       mgf     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span> macousin   maunt     mauntH  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span> hsmuncle   newmgm    mgf     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span> hsmucousin hsmuncleW hsmuncle</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># random thresholds to store as attributes</span></span>
<span><span class="va">thrs</span> <span class="op">=</span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span> id <span class="op">=</span> <span class="va">family</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span> lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span> upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="cn">Inf</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 31 × 3</span></span></span>
<span><span class="co">##    id       lower upper</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> pid       -<span style="color: #BB0000;">Inf</span>     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> sib          2     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> mhs          2     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> phs          2     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> mom          2     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> dad       -<span style="color: #BB0000;">Inf</span>   <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> dad2         2     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> paunt     -<span style="color: #BB0000;">Inf</span>   <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> pacousin     2   <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> hspaunt      2   <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 21 more rows</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="constructing-the-graph">Constructing the graph<a class="anchor" aria-label="anchor" href="#constructing-the-graph"></a>
</h3>
<p>With the above input, we can construct the graph for the population
specified in <code>family</code> and attach the information in
<code>thrs</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_graph.html">prepare_graph</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">family</span>, </span>
<span>                      thresholds <span class="op">=</span> <span class="va">thrs</span>,</span>
<span>                      fcol <span class="op">=</span> <span class="st">"dadcol"</span>,</span>
<span>                      mcol <span class="op">=</span> <span class="st">"momcol"</span>,</span>
<span>                      icol <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">graph</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH a9a881b DN-- 31 44 -- </span></span>
<span><span class="co">## + attr: name (v/c), lower (v/n), upper (v/n)</span></span>
<span><span class="co">## + edges from a9a881b (vertex names):</span></span>
<span><span class="co">##  [1] dad     -&gt;pid        mom     -&gt;pid        dad     -&gt;sib       </span></span>
<span><span class="co">##  [4] mom     -&gt;sib        dad2    -&gt;mhs        mom     -&gt;mhs       </span></span>
<span><span class="co">##  [7] dad     -&gt;phs        mom2    -&gt;phs        mgf     -&gt;mom       </span></span>
<span><span class="co">## [10] mgm     -&gt;mom        pgf     -&gt;dad        pgm     -&gt;dad       </span></span>
<span><span class="co">## [13] pgf2    -&gt;dad2       pgm2    -&gt;dad2       pgf     -&gt;paunt     </span></span>
<span><span class="co">## [16] pgm     -&gt;paunt      pauntH  -&gt;pacousin   paunt   -&gt;pacousin  </span></span>
<span><span class="co">## [19] newpgf  -&gt;hspaunt    pgm     -&gt;hspaunt    hspauntH-&gt;hspacousin</span></span>
<span><span class="co">## [22] hspaunt -&gt;hspacousin pgf     -&gt;puncle     pgm     -&gt;puncle    </span></span>
<span><span class="co">## + ... omitted several edges</span></span></code></pre>
<p>The object <code>graph</code> is a directed graph with the
connections specified in the <code>family</code> object and attributes
(attr) from <code>thrs</code>. The package <em>igraph</em> can be used
to do any manipulation of the object <code>graph</code>. The object
<code>graph</code> only contains a single family in this example,
however, it could just as easily contain the entirety of the danish CPR
register, totalling more than <span class="math inline">\(10\)</span>
million individuals. We can create a local graph (formally, a
neighborhood sub-graph) around a proband, only including individuals
that are within <span class="math inline">\(n\)</span> steps of said
proband. The <span class="math inline">\(n\)</span> steps correspond to
<span class="math inline">\(n\)</span> degree relatives, such that <span class="math inline">\(n = 1\)</span> yields all first degree relatives,
<span class="math inline">\(n = 2\)</span> yields all second degree
relatives, etc.. From this local graph, we can construct a kinship
matrix and the covariance matrix required by
<code><a href="../reference/estimate_liability.html">estimate_liability()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="extracting-local-graphs">Extracting local graphs<a class="anchor" aria-label="anchor" href="#extracting-local-graphs"></a>
</h3>
<p>If we have constructed a graph on the entire Danish CPR register and
a subset of these individuals have been genotyped, then we can create
local graphs around each of the genotyped individuals. Here, we simply
use every individual for the illustration:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">genotyped_ids</span> <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span><span class="op">$</span><span class="va">name</span></span>
<span></span>
<span><span class="va">family_graphs</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  pid <span class="op">=</span> <span class="va">genotyped_ids</span>,</span>
<span>  fam_graph <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/ego.html" class="external-link">make_ego_graph</a></span><span class="op">(</span><span class="va">graph</span>, order <span class="op">=</span> <span class="fl">2</span>, nodes <span class="op">=</span> <span class="va">pid</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here, <code>family_graphs</code> is a tibble with an id column called
“pid” and a column called “fam_graph” with list of all the local graphs,
centred on the individual from “pid”.</p>
</div>
<div class="section level3">
<h3 id="construct-kinship-matrix">Construct kinship matrix<a class="anchor" aria-label="anchor" href="#construct-kinship-matrix"></a>
</h3>
<p>We can construct a kinship matrix for a local graph in the following
way:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_kinship.html">get_kinship</a></span><span class="op">(</span><span class="va">family_graphs</span><span class="op">$</span><span class="va">fam_graph</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, h2 <span class="op">=</span> <span class="fl">1</span>, index_id <span class="op">=</span> <span class="va">family_graphs</span><span class="op">$</span><span class="va">pid</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         pid  sib  mhs  phs mom dad paunt puncle maunt  mgm  pgm  mgf  pgf pid_g</span></span>
<span><span class="co">## pid    1.00 0.50 0.25 0.25 0.5 0.5  0.25   0.25  0.25 0.25 0.25 0.25 0.25  1.00</span></span>
<span><span class="co">## sib    0.50 1.00 0.25 0.25 0.5 0.5  0.25   0.25  0.25 0.25 0.25 0.25 0.25  0.50</span></span>
<span><span class="co">## mhs    0.25 0.25 1.00 0.00 0.5 0.0  0.00   0.00  0.25 0.25 0.00 0.25 0.00  0.25</span></span>
<span><span class="co">## phs    0.25 0.25 0.00 1.00 0.0 0.5  0.25   0.25  0.00 0.00 0.25 0.00 0.25  0.25</span></span>
<span><span class="co">## mom    0.50 0.50 0.50 0.00 1.0 0.0  0.00   0.00  0.50 0.50 0.00 0.50 0.00  0.50</span></span>
<span><span class="co">## dad    0.50 0.50 0.00 0.50 0.0 1.0  0.50   0.50  0.00 0.00 0.50 0.00 0.50  0.50</span></span>
<span><span class="co">## paunt  0.25 0.25 0.00 0.25 0.0 0.5  1.00   0.50  0.00 0.00 0.50 0.00 0.50  0.25</span></span>
<span><span class="co">## puncle 0.25 0.25 0.00 0.25 0.0 0.5  0.50   1.00  0.00 0.00 0.50 0.00 0.50  0.25</span></span>
<span><span class="co">## maunt  0.25 0.25 0.25 0.00 0.5 0.0  0.00   0.00  1.00 0.50 0.00 0.50 0.00  0.25</span></span>
<span><span class="co">## mgm    0.25 0.25 0.25 0.00 0.5 0.0  0.00   0.00  0.50 1.00 0.00 0.00 0.00  0.25</span></span>
<span><span class="co">## pgm    0.25 0.25 0.00 0.25 0.0 0.5  0.50   0.50  0.00 0.00 1.00 0.00 0.00  0.25</span></span>
<span><span class="co">## mgf    0.25 0.25 0.25 0.00 0.5 0.0  0.00   0.00  0.50 0.00 0.00 1.00 0.00  0.25</span></span>
<span><span class="co">## pgf    0.25 0.25 0.00 0.25 0.0 0.5  0.50   0.50  0.00 0.00 0.00 0.00 1.00  0.25</span></span>
<span><span class="co">## pid_g  1.00 0.50 0.25 0.25 0.5 0.5  0.25   0.25  0.25 0.25 0.25 0.25 0.25  1.00</span></span></code></pre>
<p>Note: individuals such as “hspaunt” are not present, since they are
third degree relation.</p>
</div>
<div class="section level3">
<h3 id="calculating-genetic-liabilities">Calculating genetic liabilities<a class="anchor" aria-label="anchor" href="#calculating-genetic-liabilities"></a>
</h3>
<p>With the object <code>family_graphs</code>, we have constructed an
object with the required information and format for estimating the
genetic liabilities of a list of probands. We have automatically
extracted the family present for a given proband up to degree <span class="math inline">\(2\)</span> (can be generalised to any integer
<span class="math inline">\(n\)</span>), which allows us to construct
the kinship matrix. Next, we have attached the lower and upper threshold
for each individual during the construction of the graph, and as such
follow the indivdual in whatever local graph they are a part of.
Finally, we need a liability-scale heritability. We will simply use
<span class="math inline">\(h^2 = 0.5\)</span> for illustrative
purposes. We will use <code><a href="../reference/estimate_liability.html">estimate_liability()</a></code> in the folling
way:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ltfhpp</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_liability.html">estimate_liability</a></span><span class="op">(</span></span>
<span>  family_graphs <span class="op">=</span> <span class="va">family_graphs</span>,</span>
<span>  h2 <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  pid <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>  family_graphs_col <span class="op">=</span> <span class="st">"fam_graph"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The number of workers is 1</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 31 × 4</span></span></span>
<span><span class="co">##    fam_ID   pid      genetic_est genetic_se</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> pid      pid            0.986    0.002<span style="text-decoration: underline;">78</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> sib      sib            1.38     0.001<span style="text-decoration: underline;">70</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> mhs      mhs            1.63     0.001<span style="text-decoration: underline;">49</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> phs      phs            1.37     0.001<span style="text-decoration: underline;">70</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> mom      mom            1.41     0.001<span style="text-decoration: underline;">54</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> dad      dad            1.17     0.003<span style="text-decoration: underline;">00</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> dad2     dad2           1.52     0.001<span style="text-decoration: underline;">45</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> paunt    paunt          1.31     0.003<span style="text-decoration: underline;">42</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> pacousin pacousin       1.17     0.002<span style="text-decoration: underline;">23</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> hspaunt  hspaunt        1.33     0.002<span style="text-decoration: underline;">06</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 21 more rows</span></span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
