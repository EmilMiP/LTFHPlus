<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Constructing a covariance matrix for a single phenotype — construct_covmat_single • LTFHPlus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Constructing a covariance matrix for a single phenotype — construct_covmat_single"><meta name="description" content="construct_covmatc_single returns the covariance matrix for an
underlying target individual and a variable number of its family members"><meta property="og:description" content="construct_covmatc_single returns the covariance matrix for an
underlying target individual and a variable number of its family members"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LTFHPlus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/LTFHPlus.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FromCIPFamilyToLTFHPlusInput.html">From CIP and family to LT-FH++ input</a></li>
    <li><a class="dropdown-item" href="../articles/FromTrioToFamilies.html">From trio information to full families</a></li>
    <li><a class="dropdown-item" href="../articles/inputFormatExample.html">How the covariance is constructed</a></li>
    <li><a class="dropdown-item" href="../articles/LTFHPlusExample.html">LT-FH++ Example</a></li>
    <li><a class="dropdown-item" href="../articles/LTFHPlusGraphExample.html">LT-FH++ Graph Example</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EmilMiP/LTFHPlus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Constructing a covariance matrix for a single phenotype</h1>
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/master/R/Covariance_matrix_functions.R" class="external-link"><code>R/Covariance_matrix_functions.R</code></a></small>
      <div class="d-none name"><code>construct_covmat_single.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>construct_covmatc_single</code> returns the covariance matrix for an
underlying target individual and a variable number of its family members</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">construct_covmat_single</span><span class="op">(</span></span>
<span>  fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"f"</span>, <span class="st">"s1"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span><span class="op">)</span>,</span>
<span>  n_fam <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_ind <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  h2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fam-vec">fam_vec<a class="anchor" aria-label="anchor" href="#arg-fam-vec"></a></dt>
<dd><p>A vector of strings holding the different
family members. All family members must be represented by strings from the
following list:</p><ul><li><p><code>m</code> (Mother)</p></li>
<li><p><code>f</code> (Father)</p></li>
<li><p><code>c[0-9]*.[0-9]*</code> (Children)</p></li>
<li><p><code>mgm</code> (Maternal grandmother)</p></li>
<li><p><code>mgf</code> (Maternal grandfather)</p></li>
<li><p><code>pgm</code> (Paternal grandmother)</p></li>
<li><p><code>pgf</code> (Paternal grandfather)</p></li>
<li><p><code>s[0-9]*</code> (Full siblings)</p></li>
<li><p><code>mhs[0-9]*</code> (Half-siblings - maternal side)</p></li>
<li><p><code>phs[0-9]*</code> (Half-siblings - paternal side)</p></li>
<li><p><code>mau[0-9]*</code> (Aunts/Uncles - maternal side)</p></li>
<li><p><code>pau[0-9]*</code> (Aunts/Uncles - paternal side).</p></li>
</ul></dd>


<dt id="arg-n-fam">n_fam<a class="anchor" aria-label="anchor" href="#arg-n-fam"></a></dt>
<dd><p>A named vector holding the desired number of family members.
See <code><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></code>.
All names must be picked from the list mentioned above. Defaults to NULL.</p></dd>


<dt id="arg-add-ind">add_ind<a class="anchor" aria-label="anchor" href="#arg-add-ind"></a></dt>
<dd><p>A logical scalar indicating whether the genetic
component of the full liability as well as the full
liability for the underlying individual should be included in
the covariance matrix. Defaults to TRUE.</p></dd>


<dt id="arg-h-">h2<a class="anchor" aria-label="anchor" href="#arg-h-"></a></dt>
<dd><p>A number representing the squared heritability on liability scale
for a single phenotype. Must be non-negative and at most 1.
Defaults to 0.5.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If either <code>fam_vec</code> or <code>n_fam</code> is used as the argument, if it
is of the required format and <code>h2</code> is a number satisfying
\(0 \leq h2 \leq 1\), then the output will be a named covariance matrix.
The number of rows and columns corresponds to the length of <code>fam_vec</code>
or <code>n_fam</code> (+ 2 if <code>add_ind=TRUE</code>).
If both <code>fam_vec = c()/NULL</code> and <code>n_fam = c()/NULL</code>, the
function returns a \(2 \times 2\) matrix holding only the correlation
between the genetic component of the full liability and
the full liability for the individual. If both <code>fam_vec</code> and
<code>n_fam</code> are given, the user is asked to decide on which
of the two vectors to use.
Note that the returned object has different attributes, such as
<code>fam_vec</code>, <code>n_fam</code>, <code>add_ind</code> and <code>h2</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function can be used to construct a covariance matrix for
a given number of family members. Each entry in this covariance
matrix equals the percentage of shared DNA between the corresponding
individuals times the liability-scale heritability \(h^2\). The family members
can be specified using one of two possible formats.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="get_relatedness.html">get_relatedness</a></code>, <code><a href="construct_covmat_multi.html">construct_covmat_multi</a></code>,
<code><a href="construct_covmat.html">construct_covmat</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">construct_covmat_single</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         g     o    m    f    s1   mgm   mgf   pgm   pgf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g   0.500 0.500 0.25 0.25 0.250 0.125 0.125 0.125 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o   0.500 1.000 0.25 0.25 0.250 0.125 0.125 0.125 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m   0.250 0.250 1.00 0.00 0.250 0.250 0.250 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f   0.250 0.250 0.00 1.00 0.250 0.000 0.000 0.250 0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s1  0.250 0.250 0.25 0.25 1.000 0.125 0.125 0.125 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mgm 0.125 0.125 0.25 0.00 0.125 1.000 0.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mgf 0.125 0.125 0.25 0.00 0.125 0.000 1.000 0.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pgm 0.125 0.125 0.00 0.25 0.125 0.000 0.000 1.000 0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pgf 0.125 0.125 0.00 0.25 0.125 0.000 0.000 0.000 1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"fam_vec")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "g"   "o"   "m"   "f"   "s1"  "mgm" "mgf" "pgm" "pgf"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"n_fam")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   f   g   m mgf mgm   o pgf pgm   s </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   1   1   1   1   1   1   1   1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"add_ind")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"h2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-in"><span><span class="fu">construct_covmat_single</span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"mgm"</span>,<span class="st">"mgf"</span>,<span class="st">"mhs1"</span>,<span class="st">"mhs2"</span>,<span class="st">"mau1"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>n_fam <span class="op">=</span> <span class="cn">NULL</span>, add_ind <span class="op">=</span> <span class="cn">TRUE</span>, h2 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          g     o    m   mgm   mgf  mhs1  mhs2  mau1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g    0.500 0.500 0.25 0.125 0.125 0.125 0.125 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o    0.500 1.000 0.25 0.125 0.125 0.125 0.125 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m    0.250 0.250 1.00 0.250 0.250 0.250 0.250 0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mgm  0.125 0.125 0.25 1.000 0.000 0.125 0.125 0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mgf  0.125 0.125 0.25 0.000 1.000 0.125 0.125 0.250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mhs1 0.125 0.125 0.25 0.125 0.125 1.000 0.250 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mhs2 0.125 0.125 0.25 0.125 0.125 0.250 1.000 0.125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mau1 0.125 0.125 0.25 0.250 0.250 0.125 0.125 1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"fam_vec")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "g"    "o"    "m"    "mgm"  "mgf"  "mhs1" "mhs2" "mau1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"n_fam")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   g   m mau mgf mgm mhs   o </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   1   1   1   1   2   1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"add_ind")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"h2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-in"><span><span class="fu">construct_covmat_single</span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="cn">NULL</span>, n_fam <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"mgm"</span>,<span class="st">"mgf"</span>,<span class="st">"s"</span>,<span class="st">"mhs"</span><span class="op">)</span><span class="op">)</span>, add_ind <span class="op">=</span> <span class="cn">FALSE</span>, h2 <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         m   mgm   mgf    s1    s2  mhs1  mhs2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m    1.00 0.150 0.150 0.150 0.150 0.150 0.150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mgm  0.15 1.000 0.000 0.075 0.075 0.075 0.075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mgf  0.15 0.000 1.000 0.075 0.075 0.075 0.075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s1   0.15 0.075 0.075 1.000 0.150 0.075 0.075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s2   0.15 0.075 0.075 0.150 1.000 0.075 0.075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mhs1 0.15 0.075 0.075 0.075 0.075 1.000 0.150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mhs2 0.15 0.075 0.075 0.075 0.075 0.150 1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"fam_vec")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "m"    "mgm"  "mgf"  "s1"   "s2"   "mhs1" "mhs2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"n_fam")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   m mgm mgf   s mhs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   1   1   2   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"add_ind")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"h2")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

