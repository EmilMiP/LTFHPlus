<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimating the genetic or full liability for a variable number of
phenotypes — estimate_liability • LTFHPlus</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the genetic or full liability for a variable number of
phenotypes — estimate_liability"><meta property="og:description" content="estimate_liability estimates the genetic component of the full
liability and/or the full liability for a number of individuals based
on their family history for one or more phenotypes.  It is a wrapper around
estimate_liability_single and estimate_liability_multi."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FromCIPFamilyToLTFHPlusInput.html">From CIP and family to LT-FH++ input</a>
    </li>
    <li>
      <a href="../articles/FromTrioToFamilies.html">From trio information to full families</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusGraphExample.html">LT-FH++ Graph Example</a>
    </li>
    <li>
      <a href="../articles/inputFormatExample.html">How the covariance is constructed</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimating the genetic or full liability for a variable number of
phenotypes</h1>
    <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/R/Estimate_liabilities.R" class="external-link"><code>R/Estimate_liabilities.R</code></a></small>
    <div class="hidden name"><code>estimate_liability.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>estimate_liability</code> estimates the genetic component of the full
liability and/or the full liability for a number of individuals based
on their family history for one or more phenotypes.  It is a wrapper around
<code><a href="estimate_liability_single.html">estimate_liability_single</a></code> and <code><a href="estimate_liability_multi.html">estimate_liability_multi</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimate_liability</span><span class="op">(</span></span>
<span>  .tbl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family_graphs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  h2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pid <span class="op">=</span> <span class="st">"PID"</span>,</span>
<span>  fam_id <span class="op">=</span> <span class="st">"fam_ID"</span>,</span>
<span>  role <span class="op">=</span> <span class="st">"role"</span>,</span>
<span>  family_graphs_col <span class="op">=</span> <span class="st">"fam_graph"</span>,</span>
<span>  out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  genetic_corrmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  full_corrmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  phen_names <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.tbl</dt>
<dd><p>A matrix, list or data frame that can be converted into a tibble.
Must have at least five columns that hold the family identifier, the personal
identifier, the role and the lower and upper thresholds for all phenotypes
of interest. Note that the role must be one of the following abbreviations</p><ul><li><p><code>g</code> (Genetic component of full liability)</p></li>
<li><p><code>o</code> (Full liability)</p></li>
<li><p><code>m</code> (Mother)</p></li>
<li><p><code>f</code> (Father)</p></li>
<li><p><code>c[0-9]*.[0-9]*</code> (Children)</p></li>
<li><p><code>mgm</code> (Maternal grandmother)</p></li>
<li><p><code>mgf</code> (Maternal grandfather)</p></li>
<li><p><code>pgm</code> (Paternal grandmother)</p></li>
<li><p><code>pgf</code> (Paternal grandfather)</p></li>
<li><p><code>s[0-9]*</code> (Full siblings)</p></li>
<li><p><code>mhs[0-9]*</code> (Half-siblings - maternal side)</p></li>
<li><p><code>phs[0-9]*</code> (Half-siblings - paternal side)</p></li>
<li><p><code>mau[0-9]*</code> (Aunts/Uncles - maternal side)</p></li>
<li><p><code>pau[0-9]*</code> (Aunts/Uncles - paternal side).
Defaults to <code>NULL</code>.</p></li>
</ul></dd>


<dt>family_graphs</dt>
<dd><p>A tibble with columns pid and family_graph_col.
See prepare_graph for construction of the graphs. The family graphs Defaults to NULL.</p></dd>


<dt>h2</dt>
<dd><p>Either a number representing the heritability on liability scale for a
single phenotype, or a numeric vector representing the liability-scale heritabilities
for all phenotypes. All entries in h2 must be non-negative and at most 1.</p></dd>


<dt>pid</dt>
<dd><p>A string holding the name of the column in <code>family</code> and
<code>threshs</code> that hold the personal identifier(s). Defaults to <code>"PID"</code>.</p></dd>


<dt>fam_id</dt>
<dd><p>A string holding the name of the column in <code>family</code> that
holds the family identifier. Defaults to <code>"fam_ID"</code>.</p></dd>


<dt>role</dt>
<dd><p>A string holding the name of the column in <code>.tbl</code> that
holds the role.Each role must be chosen from the following list of abbreviations</p><ul><li><p><code>g</code> (Genetic component of full liability)</p></li>
<li><p><code>o</code> (Full liability)</p></li>
<li><p><code>m</code> (Mother)</p></li>
<li><p><code>f</code> (Father)</p></li>
<li><p><code>c[0-9]*.[0-9]*</code> (Children)</p></li>
<li><p><code>mgm</code> (Maternal grandmother)</p></li>
<li><p><code>mgf</code> (Maternal grandfather)</p></li>
<li><p><code>pgm</code> (Paternal grandmother)</p></li>
<li><p><code>pgf</code> (Paternal grandfather)</p></li>
<li><p><code>s[0-9]*</code> (Full siblings)</p></li>
<li><p><code>mhs[0-9]*</code> (Half-siblings - maternal side)</p></li>
<li><p><code>phs[0-9]*</code> (Half-siblings - paternal side)</p></li>
<li><p><code>mau[0-9]*</code> (Aunts/Uncles - maternal side)</p></li>
<li><p><code>pau[0-9]*</code> (Aunts/Uncles - paternal side).
Defaults to "role".</p></li>
</ul></dd>


<dt>family_graphs_col</dt>
<dd><p>Name of column with family graphs in family_graphs. Defaults to "fam_graph".</p></dd>


<dt>out</dt>
<dd><p>A character or numeric vector indicating whether the genetic component
of the full liability, the full liability or both should be returned. If <code>out = c(1)</code> or
<code>out = c("genetic")</code>, the genetic liability is estimated and returned. If <code>out = c(2)</code> or
<code>out = c("full")</code>, the full liability is estimated and returned. If <code>out = c(1,2)</code> or
<code>out = c("genetic", "full")</code>, both components are estimated and returned.
Defaults to <code>c(1)</code>.</p></dd>


<dt>tol</dt>
<dd><p>A number that is used as the convergence criterion for the Gibbs sampler.
Equals the standard error of the mean. That is, a tolerance of 0.2 means that the
standard error of the mean is below 0.2. Defaults to 0.01.</p></dd>


<dt>genetic_corrmat</dt>
<dd><p>Either <code>NULL</code> (if <code>h2</code> is a number) or a numeric
matrix (if <code>h2</code> is a vector of length &gt; 1) holding the genetic correlations
between the desired phenotypes. All diagonal entries must be equal to one, while
all off-diagonal entries must be between -1 and 1. In addition, the matrix must
be symmetric. Defaults to <code>NULL</code>.</p></dd>


<dt>full_corrmat</dt>
<dd><p>Either <code>NULL</code> (if <code>h2</code> is a number) or a numeric
matrix (if <code>h2</code> is a vector of length &gt; 1) holding the full correlations
between the desired phenotypes. All diagonal entries must be equal to one, while
all off-diagonal entries must be between -1 and 1. In addition, the matrix must
be symmetric. Defaults to <code>NULL</code>.</p></dd>


<dt>phen_names</dt>
<dd><p>Either <code>NULL</code> or a character vector holding the phenotype
names. These names will be used to create the row and column names for the
covariance matrix. If it is not specified, the names will default to
phenotype1, phenotype2, etc. Defaults to NULL.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>family</code> and <code>threshs</code> are two matrices, lists or
data frames that can be converted into tibbles, if <code>family</code> has two
columns named like the strings represented in <code>pid</code> and <code>fam_id</code>, if
<code>threshs</code> has a column named like the string given in <code>pid</code> as
well as a column named "lower" and a column named "upper" and if the
liability-scale heritability <code>h2</code> is a number (<code>length(h2)=1</code>),
and <code>out</code>, <code>tol</code> and
<code>always_add</code> are of the required form, then the function returns a
tibble with either four or six columns (depending on the length of out).
The first two columns correspond to the columns <code>fam_id</code> and <code>pid</code> '
present in <code>family</code>.
If <code>out</code> is equal to <code>c(1)</code> or <code>c("genetic")</code>, the third
and fourth column hold the estimated genetic liability as well as the
corresponding standard error, respectively.
If <code>out</code> equals <code>c(2)</code> or <code>c("full")</code>, the third and
fourth column hold the estimated full liability as well as the
corresponding standard error, respectively.
If <code>out</code> is equal to <code>c(1,2)</code> or <code>c("genetic","full")</code>,
the third and fourth column hold the estimated genetic liability as
well as the corresponding standard error, respectively, while the fifth and
sixth column hold the estimated full liability as well as the corresponding
standard error, respectively.
If <code>h2</code> is a numeric vector of length greater than 1 and if
<code>genetic_corrmat</code>, <code>full_corrmat</code>, <code>out</code> and <code>tol</code> are of the
required form, then the function returns a tibble with at least six columns (depending
on the length of out).
The first two columns correspond to the columns <code>fam_id</code> and <code>pid</code> present in
the tibble <code>family</code>.
If <code>out</code> is equal to <code>c(1)</code> or <code>c("genetic")</code>, the third and fourth columns
hold the estimated genetic liability as well as the corresponding standard error for the
first phenotype, respectively.
If <code>out</code> equals <code>c(2)</code> or <code>c("full")</code>, the third and fourth columns hold
the estimated full liability as well as the corresponding standard error for the first
phenotype, respectively.
If <code>out</code> is equal to <code>c(1,2)</code> or <code>c("genetic","full")</code>, the third and
fourth columns hold the estimated genetic liability as well as the corresponding standard
error for the first phenotype, respectively, while the fifth and sixth columns hold the
estimated full liability as well as the corresponding standard error for the first
phenotype, respectively.
The remaining columns hold the estimated genetic liabilities and/or the estimated full
liabilities as well as the corresponding standard errors for the remaining phenotypes.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function can be used to estimate either the genetic component of the
full liability, the full liability or both for a variable number of traits.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://future.apply.futureverse.org/reference/future_apply.html" class="external-link">future_apply</a></code>, <code><a href="estimate_liability_single.html">estimate_liability_single</a></code>,
<code><a href="estimate_liability_multi.html">estimate_liability_multi</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">genetic_corrmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">genetic_corrmat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">full_corrmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">full_corrmat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_under_LTM.html">simulate_under_LTM</a></span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"f"</span><span class="op">)</span>, n_fam <span class="op">=</span> <span class="cn">NULL</span>, add_ind <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>genetic_corrmat <span class="op">=</span> <span class="va">genetic_corrmat</span>, full_corrmat <span class="op">=</span> <span class="va">full_corrmat</span>, h2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">3</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>n_sim <span class="op">=</span> <span class="fl">1</span>, pop_prev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">estimate_liability</span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">sims</span><span class="op">$</span><span class="va">thresholds</span>, h2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">3</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>genetic_corrmat <span class="op">=</span> <span class="va">genetic_corrmat</span>, full_corrmat <span class="op">=</span> <span class="va">full_corrmat</span>,</span></span>
<span class="r-in"><span>pid <span class="op">=</span> <span class="st">"indiv_ID"</span>, fam_id <span class="op">=</span> <span class="st">"fam_ID"</span>, role <span class="op">=</span> <span class="st">"role"</span>, out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>phen_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"phenotype"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The number of workers is 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   fam_ID   indiv_ID genetic_phenotype1_est genetic_phenotype1_se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> fam_ID_1 fam_ID_1                  0.248               0.005<span style="text-decoration: underline;">88</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: genetic_phenotype2_est &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   genetic_phenotype2_se &lt;dbl&gt;, genetic_phenotype3_est &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   genetic_phenotype3_se &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

