<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate under the liability threshold model. — simulate_under_LTM • LTFHPlus</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate under the liability threshold model. — simulate_under_LTM"><meta property="og:description" content="simulate_under_LTM simulates thresholds under
the liability threshold model for a given family
structure."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
    <li>
      <a href="../articles/inputFormatExample.html">Input Format</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate under the liability threshold model.</h1>
    <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/R/Simulate_under_LTM.R" class="external-link"><code>R/Simulate_under_LTM.R</code></a></small>
    <div class="hidden name"><code>simulate_under_LTM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>simulate_under_LTM</code> simulates thresholds under
the liability threshold model for a given family
structure.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">simulate_under_LTM</span><span class="op">(</span>
  fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"f"</span>, <span class="st">"s1"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span><span class="op">)</span>,
  n_fam <span class="op">=</span> <span class="cn">NULL</span>,
  add_ind <span class="op">=</span> <span class="cn">TRUE</span>,
  h2 <span class="op">=</span> <span class="fl">0.5</span>,
  n_sim <span class="op">=</span> <span class="fl">1000</span>,
  pop_prev <span class="op">=</span> <span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fam_vec</dt>
<dd><p>A vector of strings holding the different
family members. All family members must be represented by strings from the
following list:</p><ul><li><p>m (Mother)</p></li>
<li><p>f (Father)</p></li>
<li><p>mgm (Maternal grandmother)</p></li>
<li><p>mgf (Maternal grandfather)</p></li>
<li><p>pgm (Paternal grandmother)</p></li>
<li><p>pgf (Paternal grandfather)</p></li>
<li><p>s[0-9]* (Full siblings)</p></li>
<li><p>mhs[0-9]* (Half-siblings - maternal side)</p></li>
<li><p>phs[0-9]* (Half-siblings - paternal side)</p></li>
<li><p>mau[0-9]* (Aunts/Uncles - maternal side)</p></li>
<li><p>pau[0-9]* (Aunts/Uncles - paternal side).
Defaults to c("m","f","s1","mgm","mgf","pgm","pgf").</p></li>
</ul></dd>
<dt>n_fam</dt>
<dd><p>A named vector holding the desired number of family members.
All names must be picked from the list mentioned above. Defaults to NULL.</p></dd>
<dt>add_ind</dt>
<dd><p>A logical scalar indicating whether the genetic
component of the full liability as well as the full
liability for the underlying individual should be included in
the covariance matrix. Defaults to TRUE.</p></dd>
<dt>h2</dt>
<dd><p>A number representing the heritability on liability scale
for a single phenotype. Must be non-negative. Note that under the liability threshold model,
the heritability must also be at most 1.
Defaults to 0.5.</p></dd>
<dt>n_sim</dt>
<dd><p>A positive number representing the number of simulations. Defaults to 1000.</p></dd>
<dt>pop_prev</dt>
<dd><p>A positive number representing the population prevalence, i.e. the
overall prevalence in the population. Must be smaller than 1. Defaults to 0.1.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If either fam_vec or n_fam is used as the argument, if it is of the required format,
if h2 is a number satisfying 0 &lt;= h2, n_sim is a strictly positive number,
and pop_prev is a positive number that is at most one,
then the output will be a list containing three tibbles. The first tibble, <code>sim_obs</code>,
holds the disease status and the current age/age of onset for all family members in each
of the <code>n_sim</code> families. The second tibble, <code>thresholds</code>, holds the lower and upper thresholds
for all individuals in all families. Note that this tibble has the format required in
<code><a href="estimate_liability.html">estimate_liability</a></code>. The last tibble, <code>fam_ID</code>, connects the personal identifiers
for all individuals to the family identifiers. As <code>thresholds</code>, <code>fam_ID</code> has the format
required in <code><a href="estimate_liability.html">estimate_liability</a></code>.
Note that if neither fam_vec nor n_fam are specified, the function returns the disease status,
the current age/age of onset, the lower and upper thresholds, as well as the personal identifier
for a single individual, namely the individual under consideration (called 'o').
If both fam_vec and n_fam are defined, the user is asked to decide on which
of the two vectors to use.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="construct_covmat.html">construct_covmat</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu">simulate_under_LTM</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sim_obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 × 34</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID       g      o         m      f      s1    mgm    mgf     pgm    pgf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1       0.026<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">1.28</span>  -<span style="color: #BB0000;">0.079</span><span style="color: #BB0000; text-decoration: underline;">3</span>   -<span style="color: #BB0000;">0.766</span>  2.18    0.793 -<span style="color: #BB0000;">0.128</span>  1.55   -<span style="color: #BB0000;">1.24</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      -<span style="color: #BB0000;">0.767</span>   0.121  0.710    -<span style="color: #BB0000;">1.73</span>  -<span style="color: #BB0000;">0.815</span>   0.485  0.290 -<span style="color: #BB0000;">0.967</span>  -<span style="color: #BB0000;">0.216</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      -<span style="color: #BB0000;">1.27</span>   -<span style="color: #BB0000;">1.02</span>   0.143    -<span style="color: #BB0000;">2.14</span>   0.406   0.235  0.967 -<span style="color: #BB0000;">1.38</span>   -<span style="color: #BB0000;">0.655</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      -<span style="color: #BB0000;">0.630</span>  -<span style="color: #BB0000;">1.99</span>   0.378     0.857  0.235   0.755 -<span style="color: #BB0000;">1.08</span>  -<span style="color: #BB0000;">0.802</span>   2.26 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5       0.375   0.532 -<span style="color: #BB0000;">1.64</span>      0.903 -<span style="color: #BB0000;">0.145</span>  -<span style="color: #BB0000;">0.216</span> -<span style="color: #BB0000;">0.583</span>  0.068<span style="text-decoration: underline;">9</span>  1.67 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6       0.088<span style="text-decoration: underline;">4</span>  0.677  0.525     0.231  0.386   1.74   1.14  -<span style="color: #BB0000;">0.030</span><span style="color: #BB0000; text-decoration: underline;">8</span>  0.654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      -<span style="color: #BB0000;">0.114</span>   0.333 -<span style="color: #BB0000;">0.200</span>     1.02  -<span style="color: #BB0000;">0.270</span>  -<span style="color: #BB0000;">0.906</span> -<span style="color: #BB0000;">0.464</span> -<span style="color: #BB0000;">0.593</span>   0.603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      -<span style="color: #BB0000;">1.86</span>   -<span style="color: #BB0000;">1.84</span>  -<span style="color: #BB0000;">1.15</span>      0.677 -<span style="color: #BB0000;">1.25</span>   -<span style="color: #BB0000;">0.270</span> -<span style="color: #BB0000;">0.580</span> -<span style="color: #BB0000;">1.29</span>    0.332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      -<span style="color: #BB0000;">0.533</span>   0.481  0.000<span style="text-decoration: underline;">619</span>  1.66   0.039<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">1.39</span>   0.311  0.469   0.511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10      0.954   0.425  0.178     0.653 -<span style="color: #BB0000;">1.23</span>   -<span style="color: #BB0000;">0.251</span>  0.840 -<span style="color: #BB0000;">0.095</span><span style="color: #BB0000; text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.852</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 990 more rows, and 24 more variables: o_status &lt;lgl&gt;, m_status &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   f_status &lt;lgl&gt;, s1_status &lt;lgl&gt;, mgm_status &lt;lgl&gt;, mgf_status &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pgm_status &lt;lgl&gt;, pgf_status &lt;lgl&gt;, o_age &lt;int&gt;, s1_age &lt;int&gt;, m_age &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   f_age &lt;int&gt;, mgm_age &lt;int&gt;, mgf_age &lt;int&gt;, pgm_age &lt;dbl&gt;, pgf_age &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   o_aoo &lt;dbl&gt;, m_aoo &lt;dbl&gt;, f_aoo &lt;dbl&gt;, s1_aoo &lt;dbl&gt;, mgm_aoo &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   mgf_aoo &lt;dbl&gt;, pgm_aoo &lt;dbl&gt;, pgf_aoo &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8,000 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fam_ID lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1_o   -<span style="color: #BB0000;">Inf</span>  2.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2_o   -<span style="color: #BB0000;">Inf</span>  2.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3_o   -<span style="color: #BB0000;">Inf</span>  2.87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4_o   -<span style="color: #BB0000;">Inf</span>  3.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5_o   -<span style="color: #BB0000;">Inf</span>  3.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6_o   -<span style="color: #BB0000;">Inf</span>  2.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7_o   -<span style="color: #BB0000;">Inf</span>  2.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8_o   -<span style="color: #BB0000;">Inf</span>  2.79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9_o   -<span style="color: #BB0000;">Inf</span>  3.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10_o  -<span style="color: #BB0000;">Inf</span>  2.72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 7,990 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fam_ID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID fam_ID   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 990 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">simulate_under_LTM</span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="cn">NULL</span>, n_fam <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"mgm"</span>,<span class="st">"mgf"</span>,<span class="st">"s"</span>,<span class="st">"mhs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., fam_ID = paste0(indiv_ID, "_", i), upper = convert_age_to_thresh(!!as.symbol(paste0(i,     "_aoo")), dist = "logistic", pop_prev = pop_prev, mid_point = 60,     slope = 1/8), lower = ifelse(!!as.symbol(paste0(i, "_status")),     convert_age_to_thresh(!!as.symbol(paste0(i, "_aoo")), dist = "logistic",         pop_prev = pop_prev, mid_point = 60, slope = 1/8), -Inf)):</span> Problem while computing `upper = convert_age_to_thresh(...)`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The error occurred in row 128.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error in `convert_age_to_thresh()`:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> The age must be non-negative!</span>
<span class="r-in"><span class="fu">simulate_under_LTM</span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"f"</span>,<span class="st">"s1"</span><span class="op">)</span>, n_fam <span class="op">=</span> <span class="cn">NULL</span>, add_ind <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span class="r-in">h2 <span class="op">=</span> <span class="fl">0.5</span>, n_sim <span class="op">=</span> <span class="fl">500</span>, pop_prev <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sim_obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID        m      f      s1 m_status f_status s1_status s1_age m_age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1       0.004<span style="text-decoration: underline;">97</span> -<span style="color: #BB0000;">2.03</span>  -<span style="color: #BB0000;">0.211</span>  FALSE    FALSE    FALSE         34    64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2       1.40     1.05  -<span style="color: #BB0000;">0.657</span>  FALSE    FALSE    FALSE         38    58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3       0.119   -<span style="color: #BB0000;">0.105</span>  0.637  FALSE    FALSE    FALSE         37    62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4       0.854   -<span style="color: #BB0000;">0.309</span>  0.375  FALSE    FALSE    FALSE         11    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5       0.194    1.12   1.34   FALSE    FALSE    FALSE         37    63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6       0.348    0.600  0.021<span style="text-decoration: underline;">6</span> FALSE    FALSE    FALSE         13    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      -<span style="color: #BB0000;">1.30</span>    -<span style="color: #BB0000;">1.67</span>  -<span style="color: #BB0000;">1.05</span>   FALSE    FALSE    FALSE         36    60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      -<span style="color: #BB0000;">0.752</span>    0.492 -<span style="color: #BB0000;">0.774</span>  FALSE    FALSE    FALSE         28    58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9       0.021<span style="text-decoration: underline;">1</span>  -<span style="color: #BB0000;">1.26</span>  -<span style="color: #BB0000;">0.396</span>  FALSE    FALSE    FALSE         30    49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     -<span style="color: #BB0000;">0.397</span>    0.502  0.807  FALSE    FALSE    FALSE         20    38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 490 more rows, and 4 more variables: f_age &lt;int&gt;, m_aoo &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   f_aoo &lt;dbl&gt;, s1_aoo &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,500 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fam_ID lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1_m   -<span style="color: #BB0000;">Inf</span>  1.86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2_m   -<span style="color: #BB0000;">Inf</span>  2.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3_m   -<span style="color: #BB0000;">Inf</span>  1.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4_m   -<span style="color: #BB0000;">Inf</span>  3.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5_m   -<span style="color: #BB0000;">Inf</span>  1.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6_m   -<span style="color: #BB0000;">Inf</span>  2.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7_m   -<span style="color: #BB0000;">Inf</span>  1.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8_m   -<span style="color: #BB0000;">Inf</span>  2.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9_m   -<span style="color: #BB0000;">Inf</span>  2.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10_m  -<span style="color: #BB0000;">Inf</span>  2.75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 1,490 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fam_ID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID fam_ID   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 490 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">simulate_under_LTM</span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, n_fam <span class="op">=</span> <span class="cn">NULL</span>, add_ind <span class="op">=</span> <span class="cn">TRUE</span>, h2 <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span class="r-in">n_sim <span class="op">=</span> <span class="fl">200</span>, pop_prev <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sim_obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 200 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID       g       o o_status o_age o_aoo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1      -<span style="color: #BB0000;">0.392</span>  -<span style="color: #BB0000;">0.036</span><span style="color: #BB0000; text-decoration: underline;">0</span> FALSE       10    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      -<span style="color: #BB0000;">0.303</span>  -<span style="color: #BB0000;">1.61</span>   FALSE       24    24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      -<span style="color: #BB0000;">0.285</span>  -<span style="color: #BB0000;">0.322</span>  FALSE       16    16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.473</span>  FALSE       15    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5      -<span style="color: #BB0000;">0.140</span>  -<span style="color: #BB0000;">0.729</span>  FALSE       40    40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      -<span style="color: #BB0000;">0.616</span>  -<span style="color: #BB0000;">0.905</span>  FALSE       32    32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      -<span style="color: #BB0000;">0.749</span>  -<span style="color: #BB0000;">0.573</span>  FALSE       12    12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8       0.811   2.91   TRUE        24    34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      -<span style="color: #BB0000;">0.057</span><span style="color: #BB0000; text-decoration: underline;">4</span> -<span style="color: #BB0000;">0.078</span><span style="color: #BB0000; text-decoration: underline;">5</span> FALSE       24    24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     -<span style="color: #BB0000;">0.881</span>  -<span style="color: #BB0000;">0.128</span>  FALSE       16    16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 190 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 200 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fam_ID   lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1_o  -<span style="color: #BB0000;">Inf</span>     3.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2_o  -<span style="color: #BB0000;">Inf</span>     3.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3_o  -<span style="color: #BB0000;">Inf</span>     3.54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4_o  -<span style="color: #BB0000;">Inf</span>     3.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5_o  -<span style="color: #BB0000;">Inf</span>     2.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6_o  -<span style="color: #BB0000;">Inf</span>     2.97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7_o  -<span style="color: #BB0000;">Inf</span>     3.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8_o     2.90  2.90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9_o  -<span style="color: #BB0000;">Inf</span>     3.26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10_o -<span style="color: #BB0000;">Inf</span>     3.54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 190 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fam_ID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 200 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID fam_ID   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 190 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

