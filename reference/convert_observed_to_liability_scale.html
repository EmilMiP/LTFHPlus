<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert the heritability on the observed scale to that on the liability scale — convert_observed_to_liability_scale • LTFHPlus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert the heritability on the observed scale to that on the liability scale — convert_observed_to_liability_scale"><meta name="description" content="convert_observed_to_liability_scale transforms the heritability on the
observed scale to the heritability on the liability scale."><meta property="og:description" content="convert_observed_to_liability_scale transforms the heritability on the
observed scale to the heritability on the liability scale."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LTFHPlus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/LTFHPlus.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FromCIPFamilyToLTFHPlusInput.html">From CIP and family to LT-FH++ input</a></li>
    <li><a class="dropdown-item" href="../articles/FromTrioToFamilies.html">From trio information to full families</a></li>
    <li><a class="dropdown-item" href="../articles/inputFormatExample.html">How the covariance is constructed</a></li>
    <li><a class="dropdown-item" href="../articles/LTFHPlusExample.html">LT-FH++ Example</a></li>
    <li><a class="dropdown-item" href="../articles/LTFHPlusGraphExample.html">LT-FH++ Graph Example</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EmilMiP/LTFHPlus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Convert the heritability on the observed scale to that on the liability scale</h1>
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/master/R/Helper_functions.R" class="external-link"><code>R/Helper_functions.R</code></a></small>
      <div class="d-none name"><code>convert_observed_to_liability_scale.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>convert_observed_to_liability_scale</code> transforms the heritability on the
observed scale to the heritability on the liability scale.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">convert_observed_to_liability_scale</span><span class="op">(</span></span>
<span>  obs_h2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pop_prev <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  prop_cases <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-obs-h-">obs_h2<a class="anchor" aria-label="anchor" href="#arg-obs-h-"></a></dt>
<dd><p>A number or numeric vector representing the liability-scale
heritability(ies)on the observed scale. Must be non-negative and at most 1.
Defaults to 0.5</p></dd>


<dt id="arg-pop-prev">pop_prev<a class="anchor" aria-label="anchor" href="#arg-pop-prev"></a></dt>
<dd><p>A number or numeric vector representing the population prevalence(s). All
entries must be non-negative and at most one.
If it is a vector, it must have the same length as obs_h2. Defaults to 0.05.</p></dd>


<dt id="arg-prop-cases">prop_cases<a class="anchor" aria-label="anchor" href="#arg-prop-cases"></a></dt>
<dd><p>Either NULL or a number or a numeric vector representing the proportion
of cases in the sample. All entries must be non-negative and at most one.
If it is a vector, it must have the same length as obs_h2. Defaults to 0.5.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>obs_h2</code>, <code>pop_prev</code> and <code>prop_cases</code> are non-negative numbers
that are at most one, the function returns the heritability on the liability
scale using Equation 23 from
Sang Hong Lee, Naomi R. Wray, Michael E. Goddard and Peter M. Visscher, "Estimating
Missing Heritability for Diseases from Genome-wide Association Studies",
The American Journal of Human Genetics, Volume 88, Issue 3, 2011, pp. 294-305,
<a href="https://doi.org/10.1016/j.ajhg.2011.02.002" class="external-link">doi:10.1016/j.ajhg.2011.02.002</a>
.
If <code>obs_h2</code>, <code>pop_prev</code> and <code>prop_cases</code> are non-negative numeric
vectors where all entries are at most one, the function returns a vector of the same
length as obs_h2. Each entry holds to the heritability on the liability
scale which was obtained from the corresponding entry in obs_h2 using Equation 23.
If <code>obs_h2</code> and <code>pop_prev</code> are non-negative numbers that are at most
one and <code>prop_cases</code> is <code>NULL</code>, the function returns the heritability
on the liability scale using Equation 17 from
Sang Hong Lee, Naomi R. Wray, Michael E. Goddard and Peter M. Visscher, "Estimating
Missing Heritability for Diseases from Genome-wide Association Studies",
The American Journal of Human Genetics, Volume 88, Issue 3, 2011, pp. 294-305,
<a href="https://doi.org/10.1016/j.ajhg.2011.02.002" class="external-link">doi:10.1016/j.ajhg.2011.02.002</a>
.
If <code>obs_h2</code> and <code>pop_prev</code> are non-negative numeric vectors such that
all entries are at most one, while <code>prop_cases</code> is <code>NULL</code>,
<code>convert_observed_to_liability_scale</code> returns a vector of the same
length as obq_h2. Each entry holds to the liability-scale heritability that
was obtained from the corresponding entry in obs_h2 using Equation 17.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function can be used to transform the heritability on the observed
scale to that on the liability scale. <code>convert_observed_to_liability_scale</code>
uses either Equation 17 (if prop_cases = NULL) or Equation 23 from
Sang Hong Lee, Naomi R. Wray, Michael E. Goddard and Peter M. Visscher, "Estimating
Missing Heritability for Diseases from Genome-wide Association Studies",
The American Journal of Human Genetics, Volume 88, Issue 3, 2011, pp. 294-305,
<a href="https://doi.org/10.1016/j.ajhg.2011.02.002" class="external-link">doi:10.1016/j.ajhg.2011.02.002</a>
 to transform the heritability on the observed
scale to the heritability on the liability scale.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sang Hong Lee, Naomi R. Wray, Michael E. Goddard, Peter M. Visscher (2011, March). Estimating
Missing Heritability for Diseases from Genome-wide Association Studies. In The American Journal
of Human Genetics (Vol. 88, Issue 3, pp. 294-305). <a href="https://doi.org/10.1016/j.ajhg.2011.02.002" class="external-link">doi:10.1016/j.ajhg.2011.02.002</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">convert_observed_to_liability_scale</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4242283</span>
<span class="r-in"><span><span class="fu">convert_observed_to_liability_scale</span><span class="op">(</span>prop_cases<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.232781</span>
<span class="r-in"><span><span class="fu">convert_observed_to_liability_scale</span><span class="op">(</span>obs_h2 <span class="op">=</span> <span class="fl">0.8</span>, pop_prev <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">44</span>, </span></span>
<span class="r-in"><span>                                    prop_cases <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.105859</span>
<span class="r-in"><span><span class="fu">convert_observed_to_liability_scale</span><span class="op">(</span>obs_h2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.8</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                    pop_prev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">44</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                    prop_cases <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.232781 6.105859</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

