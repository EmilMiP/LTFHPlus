<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Positive definite matrices — correct_positive_definite • LTFHPlus</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Positive definite matrices — correct_positive_definite"><meta property="og:description" content="correct_positive_definite verifies that a given covariance matrix
is indeed positive definite by checking that all eigenvalues are positive.
If the given covariance matrix is not positive definite,
correct_positive_definite tries to modify the underlying correlation matrix
h2 in order to obtain a positive definite covariance matrix"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
    <li>
      <a href="../articles/inputFormatExample.html">Input Format</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Positive definite matrices</h1>
    <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/R/Covariance_matrix_functions.R" class="external-link"><code>R/Covariance_matrix_functions.R</code></a></small>
    <div class="hidden name"><code>correct_positive_definite.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>correct_positive_definite</code> verifies that a given covariance matrix
is indeed positive definite by checking that all eigenvalues are positive.
If the given covariance matrix is not positive definite,
<code>correct_positive_definite</code> tries to modify the underlying correlation matrix
h2 in order to obtain a positive definite covariance matrix</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">correct_positive_definite</span><span class="op">(</span>
  <span class="va">covmat</span>,
  correction_val <span class="op">=</span> <span class="fl">0.99</span>,
  correction_limit <span class="op">=</span> <span class="fl">100</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>covmat</dt>
<dd><p>A symmetric and numeric matrix. If the covariance matrix
should be corrected, it must have a number of attributes, such as
attr(covmat,"fam_vec"), attr(covmat,"n_fam"), attr(covmat,"add_ind"),
attr(covmat,"h2") and attr(covmat,"phenotype_names"). Any covariance
matrix obtained by <code><a href="construct_covmat.html">construct_covmat</a></code>, <code><a href="construct_covmat_single.html">construct_covmat_single</a></code>
or <code><a href="construct_covmat_multi.html">construct_covmat_multi</a></code> will have these attributes by default.</p></dd>
<dt>correction_val</dt>
<dd><p>A positive number representing the amount by which
h2 will be changed, if not all eigenvalues are positive. That is, correction_val
is the number that will be multiplied to all off_diagonal entries in h2.
Defaults to 0.99.</p></dd>
<dt>correction_limit</dt>
<dd><p>A positive integer representing the upper limit for the correction
procedure. Defaults to 100.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If covmat is a symmetric and numeric matrix and all eigenvalues are
positive, <code>correct_positive_definite</code> simply returns covmat. If some
eigenvalues are not positive and correction_val is a positive number,
<code>correct_positive_definite</code> tries to convert covmat into a positive definite
matrix. If covmat has attributes "add_ind" and "h2", with h2 being
a matrix with at least two rows and columns, <code>correct_positive_definite</code>computes a new covariance matrix using a slightly modified h2. If the
correction is performed successfully, i.e. if the new covmat is positive definite,
the new covariance matrix is returned. Otherwise, <code>correct_positive_definite</code>returns the original covariance matrix.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function can be used to verify that a given covariance matrix
is positive definite. It calculates all eigenvalues in order to
investigate whether they are all positive. This property is necessary
if the covariance matrix should be used as a Gaussian covariance matrix.
It is especially useful to check whether any covariance matrix obtained
by <code><a href="construct_covmat_multi.html">construct_covmat_multi</a></code> is positive definite.
If the given covariance matrix is not positive definite, <code>correct_positive_definite</code>
tries to modify the underlying correlation matrix (called <code>h2</code> in
<code><a href="construct_covmat.html">construct_covmat</a></code> or <code><a href="construct_covmat_multi.html">construct_covmat_multi</a></code>) by
multiplying all off-diagonal entries in the correlation matrix by a given number.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="construct_covmat.html">construct_covmat</a></code>, <code><a href="construct_covmat_single.html">construct_covmat_single</a></code> and
<code><a href="construct_covmat_multi.html">construct_covmat_multi</a></code>.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

