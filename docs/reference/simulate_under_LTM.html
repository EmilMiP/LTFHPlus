<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate under the liability threshold model. — simulate_under_LTM • LTFHPlus</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate under the liability threshold model. — simulate_under_LTM"><meta property="og:description" content="simulate_under_LTM simulates thresholds under
the liability threshold model for a given family
structure."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/inputFormatExample.html">Input Format</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate under the liability threshold model.</h1>
    <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/R/Simulate_under_LTM.R" class="external-link"><code>R/Simulate_under_LTM.R</code></a></small>
    <div class="hidden name"><code>simulate_under_LTM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>simulate_under_LTM</code> simulates thresholds under
the liability threshold model for a given family
structure.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">simulate_under_LTM</span><span class="op">(</span>
  fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"f"</span>, <span class="st">"s1"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span><span class="op">)</span>,
  n_fam <span class="op">=</span> <span class="cn">NULL</span>,
  add_ind <span class="op">=</span> <span class="cn">TRUE</span>,
  h2 <span class="op">=</span> <span class="fl">0.5</span>,
  n_sim <span class="op">=</span> <span class="fl">1000</span>,
  pop_prev <span class="op">=</span> <span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fam_vec</dt>
<dd><p>A vector of strings holding the different
family members. All family members must be represented by strings from the
following list:</p><ul><li><p>m (Mother)</p></li>
<li><p>f (Father)</p></li>
<li><p>mgm (Maternal grandmother)</p></li>
<li><p>mgf (Maternal grandfather)</p></li>
<li><p>pgm (Paternal grandmother)</p></li>
<li><p>pgf (Paternal grandfather)</p></li>
<li><p>s[0-9]* (Full siblings)</p></li>
<li><p>mhs[0-9]* (Half-siblings - maternal side)</p></li>
<li><p>phs[0-9]* (Half-siblings - paternal side)</p></li>
<li><p>mau[0-9]* (Aunts/Uncles - maternal side)</p></li>
<li><p>pau[0-9]* (Aunts/Uncles - paternal side).
Defaults to c("m","f","s1","mgm","mgf","pgm","pgf").</p></li>
</ul></dd>
<dt>n_fam</dt>
<dd><p>A named vector holding the desired number of family members.
All names must be picked from the list mentioned above. Defaults to NULL.</p></dd>
<dt>add_ind</dt>
<dd><p>A logical scalar indicating whether the genetic
component of the full liability as well as the full
liability for the underlying individual should be included in
the covariance matrix. Defaults to TRUE.</p></dd>
<dt>h2</dt>
<dd><p>A number representing the heritability on liability scale
for a single phenotype. Must be non-negative. Note that under the liability threshold model,
the heritability must also be at most 1.
Defaults to 0.5.</p></dd>
<dt>n_sim</dt>
<dd><p>A positive number representing the number of simulations. Defaults to 1000.</p></dd>
<dt>pop_prev</dt>
<dd><p>A positive number representing the population prevalence, i.e. the
overall prevalence in the population. Must be smaller than 1. Defaults to 0.1.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If either fam_vec or n_fam is used as the argument, if it is of the required format,
if h2 is a number satisfying 0 &lt;= h2, n_sim is a strictly positive number,
and pop_prev is a positive number that is at most one,
then the output will be a list containing three tibbles. The first tibble, <code>sim_obs</code>,
holds the disease status and the current age/age of onset for all family members in each
of the <code>n_sim</code> families. The second tibble, <code>thresholds</code>, holds the lower and upper thresholds
for all individuals in all families. Note that this tibble has the format required in
<code><a href="estimate_liability.html">estimate_liability</a></code>. The last tibble, <code>fam_ID</code>, connects the personal identifiers
for all individuals to the family identifiers. As <code>thresholds</code>, <code>fam_ID</code> has the format
required in <code><a href="estimate_liability.html">estimate_liability</a></code>.
Note that if neither fam_vec nor n_fam are specified, the function returns the disease status,
the current age/age of onset, the lower and upper thresholds, as well as the personal identifier
for a single individual, namely the individual under consideration (called 'o').
If both fam_vec and n_fam are defined, the user is asked to decide on which
of the two vectors to use.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="construct_covmat.html">construct_covmat</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu">simulate_under_LTM</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sim_obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 x 34</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID      g      o       m      f     s1    mgm    mgf     pgm    pgf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1      -<span style="color: #BB0000;">0.810</span> -<span style="color: #BB0000;">0.689</span>  0.101   0.285 -<span style="color: #BB0000;">0.653</span> -<span style="color: #BB0000;">0.768</span>  0.119  0.565  -<span style="color: #BB0000;">0.823</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2       1.36   2.68   0.571   1.04  -<span style="color: #BB0000;">1.16</span>   0.381 -<span style="color: #BB0000;">0.915</span>  0.407   0.281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3       0.548  0.522  0.224  -<span style="color: #BB0000;">0.396</span> -<span style="color: #BB0000;">1.86</span>   1.05   0.700  1.19   -<span style="color: #BB0000;">0.486</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      -<span style="color: #BB0000;">0.989</span> -<span style="color: #BB0000;">0.366</span> -<span style="color: #BB0000;">0.607</span>  -<span style="color: #BB0000;">0.418</span> -<span style="color: #BB0000;">0.668</span> -<span style="color: #BB0000;">1.21</span>  -<span style="color: #BB0000;">0.699</span>  1.46   -<span style="color: #BB0000;">1.19</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5       0.887 -<span style="color: #BB0000;">0.192</span>  0.507   0.773  0.756 -<span style="color: #BB0000;">0.143</span>  0.893 -<span style="color: #BB0000;">0.091</span><span style="color: #BB0000; text-decoration: underline;">7</span> -<span style="color: #BB0000;">0.170</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      -<span style="color: #BB0000;">0.932</span> -<span style="color: #BB0000;">1.88</span>  -<span style="color: #BB0000;">0.540</span>  -<span style="color: #BB0000;">1.23</span>  -<span style="color: #BB0000;">0.386</span> -<span style="color: #BB0000;">2.00</span>   0.718 -<span style="color: #BB0000;">0.691</span>  -<span style="color: #BB0000;">2.21</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7       0.207 -<span style="color: #BB0000;">0.905</span> -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">4</span> -<span style="color: #BB0000;">0.102</span>  0.331 -<span style="color: #BB0000;">0.107</span>  0.233  0.569  -<span style="color: #BB0000;">1.65</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8       0.622  0.531  0.208   1.73   0.131  0.123 -<span style="color: #BB0000;">2.20</span>   1.81    0.334</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      -<span style="color: #BB0000;">1.87</span>  -<span style="color: #BB0000;">1.77</span>   0.950  -<span style="color: #BB0000;">0.798</span>  0.557 -<span style="color: #BB0000;">0.961</span> -<span style="color: #BB0000;">0.911</span> -<span style="color: #BB0000;">0.696</span>  -<span style="color: #BB0000;">0.374</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     -<span style="color: #BB0000;">0.210</span> -<span style="color: #BB0000;">1.22</span>  -<span style="color: #BB0000;">0.829</span>  -<span style="color: #BB0000;">0.163</span> -<span style="color: #BB0000;">2.08</span>   1.79  -<span style="color: #BB0000;">0.785</span> -<span style="color: #BB0000;">1.62</span>    0.361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 990 more rows, and 24 more variables: o_status &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   m_status &lt;lgl&gt;, f_status &lt;lgl&gt;, s1_status &lt;lgl&gt;, mgm_status &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   mgf_status &lt;lgl&gt;, pgm_status &lt;lgl&gt;, pgf_status &lt;lgl&gt;, o_age &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   s1_age &lt;int&gt;, m_age &lt;int&gt;, f_age &lt;int&gt;, mgm_age &lt;int&gt;, mgf_age &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pgm_age &lt;dbl&gt;, pgf_age &lt;dbl&gt;, o_aoo &lt;dbl&gt;, m_aoo &lt;dbl&gt;, f_aoo &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   s1_aoo &lt;dbl&gt;, mgm_aoo &lt;dbl&gt;, mgf_aoo &lt;dbl&gt;, pgm_aoo &lt;dbl&gt;, pgf_aoo &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8,000 x 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fam_ID   lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1_o  -<span style="color: #BB0000;">Inf</span>     3.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2_o     2.68  2.68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3_o  -<span style="color: #BB0000;">Inf</span>     3.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4_o  -<span style="color: #BB0000;">Inf</span>     3.48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5_o  -<span style="color: #BB0000;">Inf</span>     3.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6_o  -<span style="color: #BB0000;">Inf</span>     3.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7_o  -<span style="color: #BB0000;">Inf</span>     2.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8_o  -<span style="color: #BB0000;">Inf</span>     3.14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9_o  -<span style="color: #BB0000;">Inf</span>     3.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10_o -<span style="color: #BB0000;">Inf</span>     2.83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 7,990 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fam_ID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,000 x 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID fam_ID   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     <span style="color: #949494;">&lt;chr [8]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 990 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">simulate_under_LTM</span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="cn">NULL</span>, n_fam <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"mgm"</span>,<span class="st">"mgf"</span>,<span class="st">"s"</span>,<span class="st">"mhs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in mutate(., fam_ID = paste0(indiv_ID, "_", i), upper = convert_age_to_thresh(!!as.symbol(paste0(i,     "_aoo")), dist = "logistic", pop_prev = pop_prev, mid_point = 60,     slope = 1/8), lower = ifelse(!!as.symbol(paste0(i, "_status")),     convert_age_to_thresh(!!as.symbol(paste0(i, "_aoo")), dist = "logistic",         pop_prev = pop_prev, mid_point = 60, slope = 1/8), -Inf)):</span> Problem while computing `upper = convert_age_to_thresh(...)`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">i</span> The error occurred in row 149.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error in `convert_age_to_thresh()`:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> The age must be non-negative!</span>
<span class="r-in"><span class="fu">simulate_under_LTM</span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"f"</span>,<span class="st">"s1"</span><span class="op">)</span>, n_fam <span class="op">=</span> <span class="cn">NULL</span>, add_ind <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span class="r-in">h2 <span class="op">=</span> <span class="fl">0.5</span>, n_sim <span class="op">=</span> <span class="fl">500</span>, pop_prev <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sim_obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 x 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID      m       f     s1 m_status f_status s1_status s1_age m_age f_age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1       0.386  0.685  -<span style="color: #BB0000;">0.219</span> FALSE    FALSE    FALSE         25    48    50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      -<span style="color: #BB0000;">0.145</span> -<span style="color: #BB0000;">1.02</span>    0.397 FALSE    FALSE    FALSE         40    62    65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      -<span style="color: #BB0000;">0.908</span> -<span style="color: #BB0000;">0.868</span>   0.981 FALSE    FALSE    FALSE         32    56    57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4       0.696 -<span style="color: #BB0000;">0.845</span>   0.449 FALSE    FALSE    FALSE         15    44    35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5      -<span style="color: #BB0000;">0.294</span> -<span style="color: #BB0000;">0.903</span>  -<span style="color: #BB0000;">0.628</span> FALSE    FALSE    FALSE         35    63    55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      -<span style="color: #BB0000;">1.01</span>  -<span style="color: #BB0000;">0.399</span>   0.415 FALSE    FALSE    FALSE         26    49    53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7       0.111  0.021<span style="text-decoration: underline;">0</span>  1.02  FALSE    FALSE    FALSE         18    36    39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      -<span style="color: #BB0000;">0.287</span>  1.67    1.07  FALSE    TRUE     FALSE         21    48    50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      -<span style="color: #BB0000;">0.546</span> -<span style="color: #BB0000;">0.431</span>  -<span style="color: #BB0000;">0.167</span> FALSE    FALSE    FALSE         33    57    61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10      0.424 -<span style="color: #BB0000;">0.310</span>  -<span style="color: #BB0000;">0.463</span> FALSE    FALSE    FALSE         40    60    60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 490 more rows, and 3 more variables: m_aoo &lt;dbl&gt;, f_aoo &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   s1_aoo &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1,500 x 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fam_ID lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1_m   -<span style="color: #BB0000;">Inf</span>  2.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2_m   -<span style="color: #BB0000;">Inf</span>  1.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3_m   -<span style="color: #BB0000;">Inf</span>  2.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4_m   -<span style="color: #BB0000;">Inf</span>  2.51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5_m   -<span style="color: #BB0000;">Inf</span>  1.89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6_m   -<span style="color: #BB0000;">Inf</span>  2.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7_m   -<span style="color: #BB0000;">Inf</span>  2.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8_m   -<span style="color: #BB0000;">Inf</span>  2.36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9_m   -<span style="color: #BB0000;">Inf</span>  2.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10_m  -<span style="color: #BB0000;">Inf</span>  1.96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 1,490 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fam_ID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 500 x 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID fam_ID   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     <span style="color: #949494;">&lt;chr [3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 490 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu">simulate_under_LTM</span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, n_fam <span class="op">=</span> <span class="cn">NULL</span>, add_ind <span class="op">=</span> <span class="cn">TRUE</span>, h2 <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span class="r-in">n_sim <span class="op">=</span> <span class="fl">200</span>, pop_prev <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $sim_obs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 200 x 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID       g     o o_status o_age o_aoo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1       0.028<span style="text-decoration: underline;">3</span> 0.738 FALSE       18    18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      -<span style="color: #BB0000;">0.318</span>  0.737 FALSE       19    19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      -<span style="color: #BB0000;">0.428</span>  0.465 FALSE       33    33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4       0.248  0.639 FALSE       15    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5       0.138  0.237 FALSE       13    13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      -<span style="color: #BB0000;">0.643</span>  0.380 FALSE       10    10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7       0.185  0.670 FALSE       19    19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8       0.710  1.86  TRUE        17    64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      -<span style="color: #BB0000;">0.162</span>  1.08  FALSE       29    29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10      1.02   0.617 FALSE       21    21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 190 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $thresholds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 200 x 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    fam_ID   lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1_o  -<span style="color: #BB0000;">Inf</span>     3.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2_o  -<span style="color: #BB0000;">Inf</span>     3.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3_o  -<span style="color: #BB0000;">Inf</span>     2.94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4_o  -<span style="color: #BB0000;">Inf</span>     3.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5_o  -<span style="color: #BB0000;">Inf</span>     3.63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6_o  -<span style="color: #BB0000;">Inf</span>     3.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7_o  -<span style="color: #BB0000;">Inf</span>     3.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8_o     1.86  1.86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9_o  -<span style="color: #BB0000;">Inf</span>     3.09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10_o -<span style="color: #BB0000;">Inf</span>     3.37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 190 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fam_ID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 200 x 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indiv_ID fam_ID   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ID1      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ID2      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ID3      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ID4      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ID5      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ID6      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ID7      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ID8      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ID9      <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ID10     <span style="color: #949494;">&lt;chr [1]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ... with 190 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

