<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Input Format • LTFHPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Input Format">
<meta property="og:description" content="LTFHPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/inputFormatExample.html">Input Format</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Input Format</h1>
                        <h4 data-toc-skip class="author">Emil M.
Pedersen</h4>
            
            <h4 data-toc-skip class="date">2022-04-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/vignettes/inputFormatExample.Rmd" class="external-link"><code>vignettes/inputFormatExample.Rmd</code></a></small>
      <div class="hidden name"><code>inputFormatExample.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="what-is-the-input-format-for-ltfhplus-functions">What is the input format for LTFHPlus functions?<a class="anchor" aria-label="anchor" href="#what-is-the-input-format-for-ltfhplus-functions"></a>
</h2>
<p>With version 2.0, updates have been made to the input and the
functions available to estimate the (genetic) liability. Previously, a
set order was expected, where the proband was first, then followed by
father, mother, and any siblings. This limited analysis to only the
immediate family, but if information on, e.g. half-siblings,
grandparents etc, was available, it could not be readily used. Now the
input does not require a set ordering, but instead the user is expected
to provide information on the familial relation to the proband,
e.g. mother, paternal half-sibling, etc. This allows for far more
flexibility for the user to include the familial information that is
available.</p>
<div class="section level3">
<h3 id="family-input">Family Input<a class="anchor" aria-label="anchor" href="#family-input"></a>
</h3>
<p>The function used to estimate the genetic (or full liability) of an
individual is <tt>estimate_liability()</tt>. The first input needed for
this function is <tt>family</tt>. This should be an object that can be
coerced into a tibble with list entries. In short, <tt>family</tt>
consists of two columns. The first is <tt>pid</tt> and is the personal
identifier, i.e. the ID used to identifier your individuals, usually
some anonymized value. The second is <tt>fam_id</tt>, which should be a
list entry, and contains the IDs of all family members (including the
one in <tt>pid</tt>). However, <tt>fam_id</tt> must contain all family
member’s ID and end in the shorthand notation for their familial
relationship, e.g. mother must be “motherID_m”, father must be
“fatherID_f”, and siblings must be “siblingID_s[0-9]”, in order for them
to get properly read by the covariance function. Default values for
<tt>pid</tt> is <em>indiv_ID</em> and <tt>fam_id</tt> is
<em>fam_ID</em>.</p>
<p>From <tt>simulate_under_LTM()</tt> an example of the full input data
can be seen:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_under_LTM.html">simulate_under_LTM</a></span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>,<span class="st">"f"</span>,<span class="st">"s1"</span><span class="op">)</span>,</span>
<span>                            n_fam <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                            add_ind <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                            h2 <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                            n_sim<span class="op">=</span><span class="fl">100</span>, </span>
<span>                            pop_prev <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sims</span>, max.level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ sim_obs   : tibble [100 × 14] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ fam_ID   : chr [1:100] "fam_ID_1" "fam_ID_2" "fam_ID_3" "fam_ID_4" ...</span></span>
<span><span class="co">##   ..$ g        : num [1:100] -1.255 -0.789 -0.323 -0.284 -0.436 ...</span></span>
<span><span class="co">##   ..$ o        : num [1:100] -2.02 -1.992 -0.327 -0.949 -0.291 ...</span></span>
<span><span class="co">##   ..$ m        : num [1:100] -1.4601 -0.2055 0.0614 0.2882 0.3333 ...</span></span>
<span><span class="co">##   ..$ f        : num [1:100] -1.122 0.528 0.109 0.585 1.154 ...</span></span>
<span><span class="co">##   ..$ s1       : num [1:100] -1.0854 -0.1114 0.199 1.8247 -0.0119 ...</span></span>
<span><span class="co">##   ..$ o_status : logi [1:100] FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">##   ..$ m_status : logi [1:100] FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">##   ..$ f_status : logi [1:100] FALSE FALSE FALSE FALSE FALSE TRUE ...</span></span>
<span><span class="co">##   ..$ s1_status: logi [1:100] FALSE FALSE FALSE TRUE FALSE FALSE ...</span></span>
<span><span class="co">##   ..$ o_aoo    : num [1:100] 24 21 32 33 14 35 39 18 39 26 ...</span></span>
<span><span class="co">##   ..$ m_aoo    : num [1:100] 56 56 54 58 35 54 63 55 57 50 ...</span></span>
<span><span class="co">##   ..$ f_aoo    : num [1:100] 62 65 62 53 35 69 59 63 63 53 ...</span></span>
<span><span class="co">##   ..$ s1_aoo   : num [1:100] 37 37 22 66 15 25 10 67 25 62 ...</span></span>
<span><span class="co">##  $ thresholds: tibble [400 × 5] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##   ..$ fam_ID  : chr [1:400] "fam_ID_1" "fam_ID_2" "fam_ID_3" "fam_ID_4" ...</span></span>
<span><span class="co">##   ..$ indiv_ID: chr [1:400] "fam_ID_1_1" "fam_ID_2_1" "fam_ID_3_1" "fam_ID_4_1" ...</span></span>
<span><span class="co">##   ..$ role    : chr [1:400] "o" "o" "o" "o" ...</span></span>
<span><span class="co">##   ..$ lower   : num [1:400] -Inf -Inf -Inf -Inf -Inf ...</span></span>
<span><span class="co">##   ..$ upper   : num [1:400] 3.26 3.37 2.97 2.94 3.6 ...</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span><span class="op">$</span><span class="va">fam_ID</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span><span class="op">$</span><span class="va">fam_ID</span><span class="op">$</span><span class="va">fam_ID</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<p>In the above example, <tt>sims$fam_ID</tt> correspond to the family
input, with the first entry, <tt>indiv_ID</tt> containing the ID for the
proband. The <tt>indiv_ID</tt> column is primarily there to make it
easier to keep track of who each row refers to. The <tt>fam_ID</tt>
column contains list entries with the family member’s ID and familial
relationship, in the form of <em>id_familyRole</em>, where family role
refers to the short hand notation used to generate the covariance
matrix. See documentation for details.</p>
<div class="section level4">
<h4 id="covariance-function">Covariance Function<a class="anchor" aria-label="anchor" href="#covariance-function"></a>
</h4>
<p>We construct the covariance matrix for each family being analysed.
The covariance function that is used internally in
<tt>estimate_liability()</tt> has been updated to allow for a higher
degree of flexibility. This means it is up to the user to provide the
familial relationship, and <tt>construct_covmat()</tt> creates the
corresponding variances and covariances based on the heritability and
expected genetic overlap between two individuals.</p>
<p><tt>construct_covmat()</tt> defaults to a family structure with both
parents, one sibling, and the paternal and maternal grandparents. The
input format can be specified in two different ways, either
<tt>fam_vec</tt> or <tt>n_fam</tt>. For <tt>fam_vec</tt> a vector of
strings from the list of possible familial relationships. Family members
will then appear in the covariance matrix in the same order as they
appear in <tt>fam_vec</tt>. For <tt>n_fam</tt> a named vector is
provided, with the <em>names</em> of the named vector corresponding to
the familial relationship and the values of the vector corresponds to
how often that particular familial role appears. We encourage users to
look at the documentation for <tt>construct_covmat()</tt> for further
details.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># default settings:</span></span>
<span><span class="fu"><a href="../reference/construct_covmat.html">construct_covmat</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         g     o    m    f    s1   mgm   mgf   pgm   pgf</span></span>
<span><span class="co">## g   0.500 0.500 0.25 0.25 0.250 0.125 0.125 0.125 0.125</span></span>
<span><span class="co">## o   0.500 1.000 0.25 0.25 0.250 0.125 0.125 0.125 0.125</span></span>
<span><span class="co">## m   0.250 0.250 1.00 0.00 0.250 0.250 0.250 0.000 0.000</span></span>
<span><span class="co">## f   0.250 0.250 0.00 1.00 0.250 0.000 0.000 0.250 0.250</span></span>
<span><span class="co">## s1  0.250 0.250 0.25 0.25 1.000 0.125 0.125 0.125 0.125</span></span>
<span><span class="co">## mgm 0.125 0.125 0.25 0.00 0.125 1.000 0.000 0.000 0.000</span></span>
<span><span class="co">## mgf 0.125 0.125 0.25 0.00 0.125 0.000 1.000 0.000 0.000</span></span>
<span><span class="co">## pgm 0.125 0.125 0.00 0.25 0.125 0.000 0.000 1.000 0.000</span></span>
<span><span class="co">## pgf 0.125 0.125 0.00 0.25 0.125 0.000 0.000 0.000 1.000</span></span>
<span><span class="co">## attr(,"fam_vec")</span></span>
<span><span class="co">## [1] "g"   "o"   "m"   "f"   "s1"  "mgm" "mgf" "pgm" "pgf"</span></span>
<span><span class="co">## attr(,"n_fam")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   f   g   m mgf mgm   o pgf pgm   s </span></span>
<span><span class="co">##   1   1   1   1   1   1   1   1   1 </span></span>
<span><span class="co">## attr(,"add_ind")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## attr(,"h2")</span></span>
<span><span class="co">## [1] 0.5</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># only with parents</span></span>
<span><span class="fu"><a href="../reference/construct_covmat.html">construct_covmat</a></span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"f"</span><span class="op">)</span>, h2 <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      g    o    m    f</span></span>
<span><span class="co">## g 0.50 0.50 0.25 0.25</span></span>
<span><span class="co">## o 0.50 1.00 0.25 0.25</span></span>
<span><span class="co">## m 0.25 0.25 1.00 0.00</span></span>
<span><span class="co">## f 0.25 0.25 0.00 1.00</span></span>
<span><span class="co">## attr(,"fam_vec")</span></span>
<span><span class="co">## [1] "g" "o" "m" "f"</span></span>
<span><span class="co">## attr(,"n_fam")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## f g m o </span></span>
<span><span class="co">## 1 1 1 1 </span></span>
<span><span class="co">## attr(,"add_ind")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## attr(,"h2")</span></span>
<span><span class="co">## [1] 0.5</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/construct_covmat.html">construct_covmat</a></span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="cn">NULL</span>, n_fam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"f"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      g    o    m    f</span></span>
<span><span class="co">## g 0.50 0.50 0.25 0.25</span></span>
<span><span class="co">## o 0.50 1.00 0.25 0.25</span></span>
<span><span class="co">## m 0.25 0.25 1.00 0.00</span></span>
<span><span class="co">## f 0.25 0.25 0.00 1.00</span></span>
<span><span class="co">## attr(,"fam_vec")</span></span>
<span><span class="co">## [1] "g" "o" "m" "f"</span></span>
<span><span class="co">## attr(,"n_fam")</span></span>
<span><span class="co">## g o m f </span></span>
<span><span class="co">## 1 1 1 1 </span></span>
<span><span class="co">## attr(,"add_ind")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## attr(,"h2")</span></span>
<span><span class="co">## [1] 0.5</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># no family members</span></span>
<span><span class="fu"><a href="../reference/construct_covmat.html">construct_covmat</a></span><span class="op">(</span>fam_vec <span class="op">=</span> <span class="cn">NULL</span>, n_fam <span class="op">=</span> <span class="cn">NULL</span>, h2 <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning message: </span></span>
<span><span class="co">##  Neither fam_vec nor n_fam is specified...</span></span></code></pre>
<pre><code><span><span class="co">##     g   o</span></span>
<span><span class="co">## g 0.5 0.5</span></span>
<span><span class="co">## o 0.5 1.0</span></span>
<span><span class="co">## attr(,"fam_vec")</span></span>
<span><span class="co">## [1] "g" "o"</span></span>
<span><span class="co">## attr(,"n_fam")</span></span>
<span><span class="co">## g o </span></span>
<span><span class="co">## 1 1 </span></span>
<span><span class="co">## attr(,"add_ind")</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## attr(,"h2")</span></span>
<span><span class="co">## [1] 0.5</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="threshholds">Threshholds<a class="anchor" aria-label="anchor" href="#threshholds"></a>
</h3>
<p>Thresholds also need to be provided on a per individual basis. The
thresholds must be an object that can be coerced into a tibble with
three columns. The columns will be <tt>PID</tt>, <tt>lower</tt>, and
<tt>upper</tt>. the IDs for each family member</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
