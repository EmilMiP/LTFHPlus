<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>From CIP and family to LT-FH++ input • LTFHPlus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="From CIP and family to LT-FH++ input">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">LTFHPlus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/LTFHPlus.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/FromCIPFamilyToLTFHPlusInput.html">From CIP and family to LT-FH++ input</a></li>
    <li><a class="dropdown-item" href="../articles/FromTrioToFamilies.html">From trio information to full families</a></li>
    <li><a class="dropdown-item" href="../articles/inputFormatExample.html">How the covariance is constructed</a></li>
    <li><a class="dropdown-item" href="../articles/LTFHPlusExample.html">LT-FH++ Example</a></li>
    <li><a class="dropdown-item" href="../articles/LTFHPlusGraphExample.html">LT-FH++ Graph Example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EmilMiP/LTFHPlus/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>From CIP and family to LT-FH++ input</h1>
                        <h4 data-toc-skip class="author">Emil M.
Pedersen</h4>
            
            <h4 data-toc-skip class="date">2025-05-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/vignettes/FromCIPFamilyToLTFHPlusInput.Rmd" class="external-link"><code>vignettes/FromCIPFamilyToLTFHPlusInput.Rmd</code></a></small>
      <div class="d-none name"><code>FromCIPFamilyToLTFHPlusInput.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EmilMiP/LTFHPlus" class="external-link">LTFHPlus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="dummy-input">Dummy input<a class="anchor" aria-label="anchor" href="#dummy-input"></a>
</h3>
<p>Here we will simply simulate a potential input format. We create
<code>tbæ</code>, which contains information on each person to attach
thresholds to. It should contain each family member along with the
needed information. Here, we simply use the proband with no family
members. Next, we create <code>CIP</code>, which contains the cumulative
incidence proportions. The CIP is stratified by birth year and sex for
illustrative purposes. If users only have CIPs stratified by sex, it
would simply have one fewer columns. <strong>Please note that all values
shown here are only for illustrative purposes.</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_sim</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">tbl</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  fam_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"fam"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_sim</span><span class="op">)</span>,</span>
<span>  pid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sim</span>,</span>
<span>  role <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="va">n_sim</span><span class="op">)</span>,</span>
<span>  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, size <span class="op">=</span> <span class="va">n_sim</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">n_sim</span>, x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">n_sim</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">90</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>  birth_year <span class="op">=</span> <span class="fl">2023</span> <span class="op">-</span> <span class="va">age</span>,</span>
<span>  aoo <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2_dbl</a></span><span class="op">(</span>.x <span class="op">=</span> <span class="va">status</span>, .y <span class="op">=</span> <span class="va">age</span>, .f <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.x</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">.y</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">##    fam_id   pid role    sex status   age birth_year   aoo</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> fam1       1 o         0      1    55       <span style="text-decoration: underline;">1</span>968     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> fam2       2 o         0      0    43       <span style="text-decoration: underline;">1</span>980    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> fam3       3 o         1      0    62       <span style="text-decoration: underline;">1</span>961    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> fam4       4 o         0      0    43       <span style="text-decoration: underline;">1</span>980    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> fam5       5 o         0      0     5       <span style="text-decoration: underline;">2</span>018    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> fam6       6 o         1      1    85       <span style="text-decoration: underline;">1</span>938    34</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> fam7       7 o         0      0    44       <span style="text-decoration: underline;">1</span>979    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> fam8       8 o         0      0    61       <span style="text-decoration: underline;">1</span>962    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> fam9       9 o         0      1    34       <span style="text-decoration: underline;">1</span>989    25</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> fam10     10 o         1      1    70       <span style="text-decoration: underline;">1</span>953    43</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### THIS IS DUMMY CIP. DO NOT USE FOR REAL-WORLD DATA USE ####</span></span>
<span><span class="va">CIP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                       birth_year <span class="op">=</span> <span class="fl">1900</span><span class="op">:</span><span class="fl">2024</span>,</span>
<span>                       sex <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">birth_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cip <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 25,000 × 4</span></span></span>
<span><span class="co">##      age birth_year   sex   cip</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1       <span style="text-decoration: underline;">1</span>900     0 0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     2       <span style="text-decoration: underline;">1</span>900     0 0.001</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     3       <span style="text-decoration: underline;">1</span>900     0 0.002</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     4       <span style="text-decoration: underline;">1</span>900     0 0.003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     5       <span style="text-decoration: underline;">1</span>900     0 0.004</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     6       <span style="text-decoration: underline;">1</span>900     0 0.005</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     7       <span style="text-decoration: underline;">1</span>900     0 0.006</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     8       <span style="text-decoration: underline;">1</span>900     0 0.007</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     9       <span style="text-decoration: underline;">1</span>900     0 0.008</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    10       <span style="text-decoration: underline;">1</span>900     0 0.009</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 24,990 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### THIS IS DUMMY CIP. DO NOT USE FOR REAL-WORLD DATA USE ####</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="preparing-input">Preparing input<a class="anchor" aria-label="anchor" href="#preparing-input"></a>
</h3>
<p>Assigning thresholds to each person in <code>tbl</code> can now be
done with the function <code>prepare_LTFHPlus_input</code>. The
thresholds can be assigned in two ways. The first is matching directly
on the combinations of birth year, sex, and age of each person to the
combinations that are present in the <code>CIP</code> object. The second
uses interpolation to predict the CIP value between the observed
combinations of birth year, sex, and age that is present in the CIP
object. Currently, only interpolation with
<strong><em>xgboost</em></strong> package is supported. The
interpolation can be useful, since real-world data often lead to ages or
age of onsets that can be expressed as decimals and rounding may lead to
large jumps in CIP values. The outputs below can be subset such that
only the required information is left. For direct input into
<code><a href="../reference/estimate_liability.html">estimate_liability()</a></code>, only the family and personal id
columns are needed as well as role (if the graph input is not used) and
the lower and upper columns.</p>
<div class="section level4">
<h4 id="no-interpolation">No interpolation<a class="anchor" aria-label="anchor" href="#no-interpolation"></a>
</h4>
<p>Without using interpolation, meaning we match on the combinations of
birth year, sex and age that are present in both the <code>tbl</code>
and <code>CIP</code> objects. The thresholds can then be assigned in the
following way:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl2</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_LTFHPlus_input.html">prepare_LTFHPlus_input</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">tbl</span>,</span>
<span>                              CIP <span class="op">=</span> <span class="va">CIP</span>, </span>
<span>                              age_col <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>                              aoo_col <span class="op">=</span> <span class="st">"aoo"</span>,</span>
<span>                              CIP_merge_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"birth_year"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>                              CIP_cip_col <span class="op">=</span> <span class="st">"cip"</span>,</span>
<span>                              status_col <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>                              use_fixed_case_thr <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                              fam_id_col <span class="op">=</span> <span class="st">"fam_id"</span>,</span>
<span>                              personal_id_col <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                              interpolation <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                              min_CIP_value <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span></span>
<span><span class="va">tbl2</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 12</span></span></span>
<span><span class="co">##    fam_id   pid role    sex status   age birth_year   aoo   cip   thr   lower</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> fam1       1 o         0      1     4       <span style="text-decoration: underline;">1</span>968     4 0.003  2.75    2.75</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> fam2       2 o         0      0    43       <span style="text-decoration: underline;">1</span>980    <span style="color: #BB0000;">NA</span> 0.042  1.73 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> fam3       3 o         1      0    62       <span style="text-decoration: underline;">1</span>961    <span style="color: #BB0000;">NA</span> 0.061  1.55 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> fam4       4 o         0      0    43       <span style="text-decoration: underline;">1</span>980    <span style="color: #BB0000;">NA</span> 0.042  1.73 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> fam5       5 o         0      0     5       <span style="text-decoration: underline;">2</span>018    <span style="color: #BB0000;">NA</span> 0.004  2.65 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> fam6       6 o         1      1    34       <span style="text-decoration: underline;">1</span>938    34 0.033  1.84    1.84</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> fam7       7 o         0      0    44       <span style="text-decoration: underline;">1</span>979    <span style="color: #BB0000;">NA</span> 0.043  1.72 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> fam8       8 o         0      0    61       <span style="text-decoration: underline;">1</span>962    <span style="color: #BB0000;">NA</span> 0.06   1.55 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> fam9       9 o         0      1    25       <span style="text-decoration: underline;">1</span>989    25 0.024  1.98    1.98</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> fam10     10 o         1      1    43       <span style="text-decoration: underline;">1</span>953    43 0.042  1.73    1.73</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: upper &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="interpolation-with-xgboost">Interpolation with Xgboost<a class="anchor" aria-label="anchor" href="#interpolation-with-xgboost"></a>
</h4>
<p>If decimal ages and ages of onset are present, then we can
interpolate the cip values with the xgboost package. The input does not
change, except for <code>interpolate = "xgboost"</code>. The current
input data does not contain decimal values, but for illustrative
purposes, we will use it as-is. Parameters can be passed to xgboost
through the <code>bst.params</code> variable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl2_xgb</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_LTFHPlus_input.html">prepare_LTFHPlus_input</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">tbl</span>,</span>
<span>                                 CIP <span class="op">=</span> <span class="va">CIP</span>, </span>
<span>                                 age_col <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>                                 aoo_col <span class="op">=</span> <span class="st">"aoo"</span>,</span>
<span>                                 CIP_merge_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"birth_year"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span>
<span>                                 CIP_cip_col <span class="op">=</span> <span class="st">"cip"</span>,</span>
<span>                                 status_col <span class="op">=</span> <span class="st">"status"</span>,</span>
<span>                                 use_fixed_case_thr <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                                 fam_id_col <span class="op">=</span> <span class="st">"fam_id"</span>,</span>
<span>                                 personal_id_col <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                                 interpolation <span class="op">=</span> <span class="st">"xgboost"</span>, </span>
<span>                                 xgboost_itr <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                                 min_CIP_value <span class="op">=</span> <span class="fl">1e-4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  train-rmse:0.040135 </span></span>
<span><span class="co">## [2]  train-rmse:0.028111 </span></span>
<span><span class="co">## [3]  train-rmse:0.019688 </span></span>
<span><span class="co">## [4]  train-rmse:0.013790 </span></span>
<span><span class="co">## [5]  train-rmse:0.009659 </span></span>
<span><span class="co">## [6]  train-rmse:0.006766 </span></span>
<span><span class="co">## [7]  train-rmse:0.004740 </span></span>
<span><span class="co">## [8]  train-rmse:0.003321 </span></span>
<span><span class="co">## [9]  train-rmse:0.002328 </span></span>
<span><span class="co">## [10] train-rmse:0.001632 </span></span>
<span><span class="co">## [11] train-rmse:0.001144 </span></span>
<span><span class="co">## [12] train-rmse:0.000802 </span></span>
<span><span class="co">## [13] train-rmse:0.000563 </span></span>
<span><span class="co">## [14] train-rmse:0.000395 </span></span>
<span><span class="co">## [15] train-rmse:0.000278 </span></span>
<span><span class="co">## [16] train-rmse:0.000196 </span></span>
<span><span class="co">## [17] train-rmse:0.000139 </span></span>
<span><span class="co">## [18] train-rmse:0.000101 </span></span>
<span><span class="co">## [19] train-rmse:0.000075 </span></span>
<span><span class="co">## [20] train-rmse:0.000058 </span></span>
<span><span class="co">## [21] train-rmse:0.000047 </span></span>
<span><span class="co">## [22] train-rmse:0.000041 </span></span>
<span><span class="co">## [23] train-rmse:0.000037 </span></span>
<span><span class="co">## [24] train-rmse:0.000035 </span></span>
<span><span class="co">## [25] train-rmse:0.000034 </span></span>
<span><span class="co">## [26] train-rmse:0.000034 </span></span>
<span><span class="co">## [27] train-rmse:0.000034 </span></span>
<span><span class="co">## [28] train-rmse:0.000034 </span></span>
<span><span class="co">## [29] train-rmse:0.000034 </span></span>
<span><span class="co">## [30] train-rmse:0.000034</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl2_xgb</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 13</span></span></span>
<span><span class="co">##    fam_id   pid role    sex status   age birth_year   aoo cip_pred event_age</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> fam1       1 o         0      1    55       <span style="text-decoration: underline;">1</span>968     4  0.003<span style="text-decoration: underline;">02</span>         4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> fam5       5 o         0      0     5       <span style="text-decoration: underline;">2</span>018    <span style="color: #BB0000;">NA</span>  0.004<span style="text-decoration: underline;">01</span>         5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> fam9       9 o         0      1    34       <span style="text-decoration: underline;">1</span>989    25  0.024<span style="text-decoration: underline;">0</span>         25</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> fam6       6 o         1      1    85       <span style="text-decoration: underline;">1</span>938    34  0.033<span style="text-decoration: underline;">0</span>         34</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> fam2       2 o         0      0    43       <span style="text-decoration: underline;">1</span>980    <span style="color: #BB0000;">NA</span>  0.042<span style="text-decoration: underline;">0</span>         43</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> fam4       4 o         0      0    43       <span style="text-decoration: underline;">1</span>980    <span style="color: #BB0000;">NA</span>  0.042<span style="text-decoration: underline;">0</span>         43</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> fam10     10 o         1      1    70       <span style="text-decoration: underline;">1</span>953    43  0.042<span style="text-decoration: underline;">0</span>         43</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> fam7       7 o         0      0    44       <span style="text-decoration: underline;">1</span>979    <span style="color: #BB0000;">NA</span>  0.043<span style="text-decoration: underline;">0</span>         44</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> fam8       8 o         0      0    61       <span style="text-decoration: underline;">1</span>962    <span style="color: #BB0000;">NA</span>  0.060<span style="text-decoration: underline;">0</span>         61</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> fam3       3 o         1      0    62       <span style="text-decoration: underline;">1</span>961    <span style="color: #BB0000;">NA</span>  0.060<span style="text-decoration: underline;">9</span>         62</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: thr &lt;dbl&gt;, lower &lt;dbl&gt;, upper &lt;dbl&gt;</span></span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="estimating-liabilities">Estimating liabilities<a class="anchor" aria-label="anchor" href="#estimating-liabilities"></a>
</h3>
<p>From here, the above objects <code>tbl2</code> and
<code>tbl2_xgb</code> can be subset to the relevant columns and used in
<code><a href="../reference/estimate_liability.html">estimate_liability()</a></code>. See <strong><em>LT-FH++
Example</em></strong> for an example of this.</p>
<p>The objects can also be subset to contain just the family and
personal ID columns, as well as the lower and upper columns, and then
used as input in <code><a href="../reference/prepare_graph.html">prepare_graph()</a></code> to assign each individual
with the threshold information as attributes. See <strong><em>LT-FH++
Graph Example</em></strong> for details.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
