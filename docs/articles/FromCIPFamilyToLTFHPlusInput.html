<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>From CIP and family to LT-FH++ input â€¢ LTFHPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="From CIP and family to LT-FH++ input">
<meta property="og:description" content="LTFHPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FromCIPFamilyToLTFHPlusInput.html">From CIP and family to LT-FH++ input</a>
    </li>
    <li>
      <a href="../articles/FromTrioToFamilies.html">From trio information to full families</a>
    </li>
    <li>
      <a href="../articles/inputFormatExample.html">How the covariance is constructed</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>From CIP and family to LT-FH++ input</h1>
                        <h4 data-toc-skip class="author">Emil M.
Pedersen</h4>
            
            <h4 data-toc-skip class="date">2024-01-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/vignettes/FromCIPFamilyToLTFHPlusInput.Rmd" class="external-link"><code>vignettes/FromCIPFamilyToLTFHPlusInput.Rmd</code></a></small>
      <div class="hidden name"><code>FromCIPFamilyToLTFHPlusInput.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EmilMiP/LTFHPlus" class="external-link">LTFHPlus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="dummy-input">dummy input<a class="anchor" aria-label="anchor" href="#dummy-input"></a>
</h3>
<p>Here we will simply simulate a potential input format. We create
<code>fam</code>, which contains the family information and
<code>CIP</code>, which contains the cumulative incidence proportions.
The CIP is stratified by birth year and sex for illustrative purposes.
If users only have CIPs stratified by sex, it would simply have one
fewer columns. <strong>Please note that all values shown here are only
for illustrative purposes.</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fam</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>fam_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fam_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             pid    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pid    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pid"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pid"</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pid11"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             role   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>role   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"f"</span>, <span class="st">"m"</span>, <span class="st">"s1"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"f"</span>, <span class="st">"m"</span>, <span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                                      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"o"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fam_id</span>, <span class="va">pid</span>, <span class="va">role</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co">#just adding some info as an example</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sex    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>         status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>         age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">100</span>, size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>         aoo    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">cur_ind</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">status</span><span class="op">[</span><span class="va">cur_ind</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="va">age</span><span class="op">[</span><span class="va">cur_ind</span><span class="op">]</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                  <span class="cn">NA</span><span class="op">)</span></span>
<span>           <span class="op">}</span><span class="op">)</span>,</span>
<span><span class="co">#         event = pmin(current_age, aoo, na.rm = T),</span></span>
<span>         birth_year <span class="op">=</span> <span class="fl">2022</span> <span class="op">-</span> <span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 Ã— 8</span></span></span>
<span><span class="co">##   fam_id pid       role        sex status   age   aoo birth_year</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      1 <span style="color: #949494;">&lt;chr [4]&gt;</span> <span style="color: #949494;">&lt;chr [4]&gt;</span>     0      1    96    36       <span style="text-decoration: underline;">1</span>926</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      2 <span style="color: #949494;">&lt;chr [6]&gt;</span> <span style="color: #949494;">&lt;chr [6]&gt;</span>     1      0    94    <span style="color: #BB0000;">NA</span>       <span style="text-decoration: underline;">1</span>928</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      3 <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;chr [1]&gt;</span>     1      1    33    28       <span style="text-decoration: underline;">1</span>989</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### THIS IS DUMMY CIP. DO NOT USE FOR REAL-WORLD DATA USE ####</span></span>
<span><span class="va">CIP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>                       birth_year <span class="op">=</span> <span class="fl">1900</span><span class="op">:</span><span class="fl">2022</span>,</span>
<span>                       sex <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span>, <span class="va">birth_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cip <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 24,600 Ã— 4</span></span></span>
<span><span class="co">##      age birth_year   sex   cip</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     1       <span style="text-decoration: underline;">1</span>900     0 0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     2       <span style="text-decoration: underline;">1</span>900     0 0.001</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     3       <span style="text-decoration: underline;">1</span>900     0 0.002</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     4       <span style="text-decoration: underline;">1</span>900     0 0.003</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     5       <span style="text-decoration: underline;">1</span>900     0 0.004</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     6       <span style="text-decoration: underline;">1</span>900     0 0.005</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     7       <span style="text-decoration: underline;">1</span>900     0 0.006</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     8       <span style="text-decoration: underline;">1</span>900     0 0.007</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     9       <span style="text-decoration: underline;">1</span>900     0 0.008</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    10       <span style="text-decoration: underline;">1</span>900     0 0.009</span></span>
<span><span class="co">## <span style="color: #949494;"># â€¦ with 24,590 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># â„¹ Use `print(n = ...)` to see more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### THIS IS DUMMY CIP. DO NOT USE FOR REAL-WORLD DATA USE ####</span></span></code></pre></div>
<p>In <code>fam</code> we have list entries, corresponding to an input
format that is still supported, but for ease of use, will be replaced by
a longer format. If the list entry format is used, a note will be
printed that tells the users that a conversion happened internally. It
will look like this:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input</span> <span class="op">=</span>  <span class="fu"><a href="../reference/prepare_LTFHPlus_input.html">prepare_LTFHPlus_input</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">fam</span>, CIP <span class="op">=</span> <span class="va">CIP</span>, age_col <span class="op">=</span> <span class="st">"age"</span>, aoo_col <span class="op">=</span> <span class="st">"aoo"</span>, role_col <span class="op">=</span> <span class="st">"role"</span>, use_fixed_case_thr <span class="op">=</span> <span class="cn">F</span>, interpolation <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_fam</span> <span class="op">=</span> <span class="va">input</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pid</span>, <span class="va">role</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">pid</span>, <span class="st">"_"</span>, <span class="va">role</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">fam_id</span>, <span class="va">pid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pid</span><span class="op">)</span></span>
<span><span class="va">thr</span> <span class="op">=</span> <span class="va">input</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">pid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">role</span>, <span class="op">-</span><span class="va">fam_id</span><span class="op">)</span><span class="co"># %&gt;% rename(fam_id2 = fam_id, fam_id = pid) %&gt;% rename(pid = fam_id2) %&gt;% select(-1)</span></span>
<span></span>
<span><span class="va">.tbl</span> <span class="op">=</span> <span class="fu"><a href="../reference/convert_format.html">convert_format</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">input_fam</span>, threshs <span class="op">=</span> <span class="va">thr</span>, personal_id_col <span class="op">=</span> <span class="st">"pid"</span>, role_col <span class="op">=</span> <span class="st">"role"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## We've tried converting from list entries to a long format internally. If you see this print, please run prepare_LTFHPlus_input and use the .tbl input going forward!</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">.tbl</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 11 Ã— 12</span></span></span>
<span><span class="co">##    fam_id pid   role    sex status   age   aoo birth_year   cip   thr   lower</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      1 pid1  o         0      1    96    36       <span style="text-decoration: underline;">1</span>926 0.095  1.31    1.31</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      1 pid2  f         0      1    96    36       <span style="text-decoration: underline;">1</span>926 0.095  1.31    1.31</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      1 pid3  m         0      1    96    36       <span style="text-decoration: underline;">1</span>926 0.095  1.31    1.31</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      1 pid4  s1        0      1    96    36       <span style="text-decoration: underline;">1</span>926 0.095  1.31    1.31</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      2 pid5  o         1      0    94    <span style="color: #BB0000;">NA</span>       <span style="text-decoration: underline;">1</span>928 0.093  1.32 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      2 pid6  f         1      0    94    <span style="color: #BB0000;">NA</span>       <span style="text-decoration: underline;">1</span>928 0.093  1.32 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      2 pid7  m         1      0    94    <span style="color: #BB0000;">NA</span>       <span style="text-decoration: underline;">1</span>928 0.093  1.32 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      2 pid8  s1        1      0    94    <span style="color: #BB0000;">NA</span>       <span style="text-decoration: underline;">1</span>928 0.093  1.32 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      2 pid9  s2        1      0    94    <span style="color: #BB0000;">NA</span>       <span style="text-decoration: underline;">1</span>928 0.093  1.32 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      2 pid10 s3        1      0    94    <span style="color: #BB0000;">NA</span>       <span style="text-decoration: underline;">1</span>928 0.093  1.32 -<span style="color: #BB0000;">Inf</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>      3 pid11 o         1      1    33    28       <span style="text-decoration: underline;">1</span>989 0.032  1.85    1.85</span></span>
<span><span class="co">## <span style="color: #949494;"># â€¦ with 1 more variable: upper &lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #949494;"># â„¹ Use `colnames()` to see all variable names</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="estimating-liabilities">Estimating liabilities<a class="anchor" aria-label="anchor" href="#estimating-liabilities"></a>
</h3>
<p>From here both input formats can be used to estimate the desired
liabilities. Either with the set of inputs <code>family</code> and
<code>threshs</code> that is based on the list entries or the long
format supported by <code>.tbl</code>. For the long format the input is
given as</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_liability.html">estimate_liability</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">input_fam</span>,</span>
<span>                   threshs <span class="op">=</span> <span class="va">thr</span>,</span>
<span>                   h2 <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>                   pid <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                   fam_id <span class="op">=</span> <span class="st">"fam_id"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## We've tried converting from list entries to a long format internally. If you see this print, please run prepare_LTFHPlus_input and use the .tbl input going forward! </span></span>
<span><span class="co">## The number of workers is 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 Ã— 4</span></span></span>
<span><span class="co">##   fam_id pid   genetic_est       genetic_se         </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1      pid1  1.4537238063454   0.00221564855871935</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2      pid5  -0.23800788869239 0.00354433829721992</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 3      pid11 1.12332893653117  0.00181671439884389</span></span></code></pre>
<p>A note is printed to let the user know that the conversion to the
longer format happened internally, suggesting the use of the longer
format. The output should be the same. If the conversion fails, an error
will be given, with another suggestion to use the longer format and the
<code>prepare_LTFHPlus_input</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_liability.html">estimate_liability</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">.tbl</span>,</span>
<span>                   h2 <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>                   pid <span class="op">=</span> <span class="st">"pid"</span>,</span>
<span>                   fam_id <span class="op">=</span> <span class="st">"fam_id"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The number of workers is 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 Ã— 4</span></span></span>
<span><span class="co">##   fam_id pid   genetic_est        genetic_se         </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 1      pid1  1.45744872267092   0.00216808926684047</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2      pid5  -0.235208629785654 0.00349441268373768</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 3      pid11 1.12221254229849   0.00187248810080137</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emil Michael Pedersen, Florian PrivÃ©, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
