<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LT-FH++ Example No Family History • LTFHPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="LT-FH++ Example No Family History">
<meta property="og:description" content="LTFHPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusExampleNoFH.html">LT-FH++ Example No Family History</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="LTFHPlusExampleNoFH_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>LT-FH++ Example No Family History</h1>
                        <h4 class="author">Emil M. Pedersen</h4>
            
            <h4 class="date">7/7/2021</h4>
      
      
      <div class="hidden name"><code>LTFHPlusExampleNoFH.Rmd</code></div>

    </div>

    
    
<p>First, we will load the packages that we will need for the example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">LTFHPlus</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/future.apply">future.apply</a></span><span class="op">)</span></code></pre></div>
<div id="global-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#global-parameters" class="anchor"></a>Global parameters</h3>
<p>The strategy from here is to generate the necessary information for each individual in the example. We will start out by setting some global parameters:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">=</span> <span class="fl">10000</span> <span class="co">#number of individuals</span>
<span class="va">h2</span> <span class="op">=</span> <span class="fl">.5</span> <span class="co">#heritability</span>

<span class="co">#calculates the sex-specific prevalences used to determine status:</span>
<span class="va">multiplier</span> <span class="op">=</span> <span class="fl">1</span>
<span class="va">prev</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.08</span>, <span class="fl">0.02</span><span class="op">)</span> <span class="op">*</span> <span class="va">multiplier</span>

<span class="va">nthreads</span> <span class="op">=</span> <span class="fl">5</span>  <span class="co"># number of threads to use for LT-FH++ with no FH</span></code></pre></div>
<p>It is worth noting that these values can be set more or less anything the reader would want/need. Our choice of prevalence vector is to illustrate LT-FH++’s ability to estimate the genetic liability, even when the cases are not equally distributed between the sexes. Other prevalence vectors could be used, for instance one with the same prevalence between sexes.</p>
</div>
<div id="setting-up-input" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-up-input" class="anchor"></a>Setting up input</h3>
<p>Simulating liabilities with no family history is slightly easier, since the multivariate normal only has two entries, one for the genetic and one for the full liability.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#covariance matrix with no FH</span>
<span class="va">cov_mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">h2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">cov_mat</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span>


<span class="co">#simulate liabilities &amp; make tibble</span>
<span class="va">liabs</span> <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">cov_mat</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"child_gen"</span>  <span class="op">=</span> <span class="st">"V1"</span>,
         <span class="st">"child_full"</span> <span class="op">=</span> <span class="st">"V2"</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.</code></pre>
<div id="generating-phen" class="section level4">
<h4 class="hasAnchor">
<a href="#generating-phen" class="anchor"></a>Generating phen</h4>
<p>When we want to estimate the genetic liability for en individual without any family history, we only need the <strong><em>phen</em></strong> object. In short, <strong><em>phen</em></strong> will contain the ids and upper and lower limit for the full liability.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#construct phen</span>
<span class="va">phen</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
  ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span>,
  child_gen  <span class="op">=</span> <span class="va">liabs</span><span class="op">$</span><span class="va">child_gen</span>,
  child_full <span class="op">=</span> <span class="va">liabs</span><span class="op">$</span><span class="va">child_full</span>,
  age  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">10</span>, <span class="fl">60</span><span class="op">)</span>,
  sex        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, size <span class="op">=</span> <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="co"># 1 and 2 to avoid "+1" through out the example</span>
  status     <span class="op">=</span> <span class="op">(</span><span class="va">child_full</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">prev</span><span class="op">[</span><span class="va">sex</span><span class="op">]</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0L</span>,
  lower      <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,
  upper      <span class="op">=</span> <span class="cn">Inf</span>
<span class="op">)</span> 

<span class="co">#who are the cases?</span>
<span class="va">cases</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">phen</span><span class="op">$</span><span class="va">status</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> 
<span class="co">#fill in aoo</span>
<span class="va">phen</span><span class="op">$</span><span class="va">aoo</span> <span class="op">=</span> <span class="cn">NA</span>
<span class="va">phen</span><span class="op">$</span><span class="va">aoo</span><span class="op">[</span><span class="va">cases</span><span class="op">]</span> <span class="op">=</span> <span class="fu">LTFHPlus</span><span class="fu">::</span><span class="fu"><a href="../reference/liab_to_aoo.html">liab_to_aoo</a></span><span class="op">(</span>liab <span class="op">=</span> <span class="va">phen</span><span class="op">$</span><span class="va">child_full</span><span class="op">[</span><span class="va">cases</span><span class="op">]</span>, pop_prev <span class="op">=</span> <span class="va">prev</span><span class="op">[</span><span class="va">phen</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="va">cases</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#fill in upper and lower limit</span>
<span class="va">phen</span><span class="op">$</span><span class="va">upper</span><span class="op">[</span><span class="op">-</span><span class="va">cases</span><span class="op">]</span> <span class="op">=</span> <span class="fu">LTFHPlus</span><span class="fu">::</span><span class="fu"><a href="../reference/age_to_thres.html">age_to_thres</a></span><span class="op">(</span>age      <span class="op">=</span> <span class="va">phen</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="op">-</span><span class="va">cases</span><span class="op">]</span>, 
                                            pop_prev <span class="op">=</span> <span class="va">prev</span><span class="op">[</span><span class="va">phen</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="op">-</span><span class="va">cases</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">phen</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span><span class="va">cases</span><span class="op">]</span>  <span class="op">=</span> <span class="fu">LTFHPlus</span><span class="fu">::</span><span class="fu"><a href="../reference/age_to_thres.html">age_to_thres</a></span><span class="op">(</span>age      <span class="op">=</span> <span class="va">phen</span><span class="op">$</span><span class="va">aoo</span><span class="op">[</span><span class="va">cases</span><span class="op">]</span>, 
                                            pop_prev <span class="op">=</span> <span class="va">prev</span><span class="op">[</span><span class="va">phen</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="va">cases</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

<span class="co"># keep only relevant information</span>
<span class="va">phen</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">phen</span>, <span class="va">ids</span>, <span class="va">status</span>, <span class="va">lower</span>, <span class="va">upper</span>, <span class="va">child_gen</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 10,000 x 5
##      ids status lower upper child_gen
##    &lt;int&gt;  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1     1      0  -Inf  3.73    -0.378
##  2     2      0  -Inf  3.20     0.121
##  3     3      0  -Inf  2.63     0.391
##  4     4      0  -Inf  3.10     0.753
##  5     5      0  -Inf  2.06    -0.637
##  6     6      0  -Inf  3.78    -0.182
##  7     7      0  -Inf  3.34    -0.757
##  8     8      0  -Inf  2.98     0.933
##  9     9      0  -Inf  2.52     0.802
## 10    10      0  -Inf  3.71    -0.325
## # ... with 9,990 more rows</code></pre>
<p><strong><em>phen</em></strong> contains the prevalence information, e.g. age &amp; sex, needed to find the upper and lower limit. Strictly speaking, only the ids, lower and upper limit is necessary from this point on.</p>
</div>
</div>
<div id="running-lt-fh-no-family-history" class="section level3">
<h3 class="hasAnchor">
<a href="#running-lt-fh-no-family-history" class="anchor"></a>Running LT-FH++ no family history</h3>
<p>With all input parameters generated and the heritability set in the global settings, we have everything we need to run <em>LT-FH++</em>. The package <strong>Future.apply</strong> can be used to parallelize the computations for LT-FH++, and we highly recommend doing this, since all modern computers have more than 2 cores available to them. The future framework also allows for easy use on high performance computing (HPC) clusters. In this example, we will utilize 5 threads.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#start parallelization</span>
<span class="fu">plan</span><span class="op">(</span><span class="fu">tweak</span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="va">nthreads</span><span class="op">)</span><span class="op">)</span>

<span class="va">ltfhpp_nofh</span> <span class="op">=</span> <span class="fu"><a href="../reference/estimate_gen_liability_noFH.html">estimate_gen_liability_noFH</a></span><span class="op">(</span>phen <span class="op">=</span> <span class="va">phen</span>, h2 <span class="op">=</span> <span class="va">h2</span><span class="op">)</span>
<span class="va">ltfhpp_nofh</span></code></pre></div>
<pre><code>## # A tibble: 10,000 x 7
##      ids status lower upper child_gen post_gen_no_fam post_gen_no_fam_se
##    &lt;int&gt;  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;           &lt;dbl&gt;              &lt;dbl&gt;
##  1     1      0  -Inf  3.73    -0.378         0.00857            0.00580
##  2     2      0  -Inf  3.20     0.121        -0.00703            0.00528
##  3     3      0  -Inf  2.63     0.391        -0.00256            0.00550
##  4     4      0  -Inf  3.10     0.753         0.00537            0.00513
##  5     5      0  -Inf  2.06    -0.637        -0.0275             0.00574
##  6     6      0  -Inf  3.78    -0.182        -0.00329            0.00529
##  7     7      0  -Inf  3.34    -0.757        -0.0119             0.00525
##  8     8      0  -Inf  2.98     0.933         0.00186            0.00529
##  9     9      0  -Inf  2.52     0.802        -0.0124             0.00523
## 10    10      0  -Inf  3.71    -0.325         0.00390            0.00568
## # ... with 9,990 more rows</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Emil Michael Pedersen, Florian Privé.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
