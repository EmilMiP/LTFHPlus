<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>From trio information to full families • LTFHPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="From trio information to full families">
<meta property="og:description" content="LTFHPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LTFHPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/LTFHPlus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/FromCIPFamilyToLTFHPlusInput.html">From CIP and family to LT-FH++ input</a>
    </li>
    <li>
      <a href="../articles/FromTrioToFamilies.html">From trio information to full families</a>
    </li>
    <li>
      <a href="../articles/inputFormatExample.html">How the covariance is constructed</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusExample.html">LT-FH++ Example</a>
    </li>
    <li>
      <a href="../articles/LTFHPlusGraphExample.html">LT-FH++ Graph Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EmilMiP/LTFHPlus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>From trio information to full families</h1>
                        <h4 data-toc-skip class="author">Emil M.
Pedersen</h4>
            
            <h4 data-toc-skip class="date">2024-01-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EmilMiP/LTFHPlus/blob/HEAD/vignettes/FromTrioToFamilies.Rmd" class="external-link"><code>vignettes/FromTrioToFamilies.Rmd</code></a></small>
      <div class="hidden name"><code>FromTrioToFamilies.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EmilMiP/LTFHPlus" class="external-link">LTFHPlus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span></code></pre></div>
<p>In this document, we will present how we can go from trio information
to full families that can be used to calculate kinship matrices. By trio
information, we specifically mean knowing the id of the child and the id
of the child’s mother and father. Kinship matrices are essential when
estimating the liabilities with the <code><a href="../reference/estimate_liability.html">estimate_liability()</a></code>
function of the package. This addition help with the process of
identifying related individuals and subsequent construction of the
kinship matrix.</p>
<div class="section level3">
<h3 id="from-trio-information-to-graph">From trio information to graph<a class="anchor" aria-label="anchor" href="#from-trio-information-to-graph"></a>
</h3>
<p>The trio information can be used to create extended families manually
by first identifying parents, grandparents, great-grandparents, etc..
From there, siblings, aunts and uncles, cousins, etc.. can also be
identified. However, this is a tedious process and it is easy to miss
family members. We have developed a function that can find all family
member that are related of degree <span class="math inline">\(n\)</span>
or closer that does not rely on the tedious process of identifying each
family role manually.</p>
<p>Below is an example data set of a family. It contains half-siblings,
half-aunts and -uncles, as well as cousins and individuals that have
married into the family. An example is <em>mgm</em> meaning <em>maternal
grandmother</em>, <em>hspaunt</em> meaning <em>paternal half-aunt</em>,
or <em>hsmuncleW</em> meaning <em>maternal half-uncle’s wife</em>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">family</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">id</span>, <span class="op">~</span><span class="va">momcol</span>, <span class="op">~</span><span class="va">dadcol</span>,</span>
<span>  <span class="st">"pid"</span>, <span class="st">"mom"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"sib"</span>, <span class="st">"mom"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"mhs"</span>, <span class="st">"mom"</span>, <span class="st">"dad2"</span>,</span>
<span>  <span class="st">"phs"</span>, <span class="st">"mom2"</span>, <span class="st">"dad"</span>,</span>
<span>  <span class="st">"mom"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"dad"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"dad2"</span>, <span class="st">"pgm2"</span>, <span class="st">"pgf2"</span>,</span>
<span>  <span class="st">"paunt"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"pacousin"</span>, <span class="st">"paunt"</span>, <span class="st">"pauntH"</span>,</span>
<span>  <span class="st">"hspaunt"</span>, <span class="st">"pgm"</span>, <span class="st">"newpgf"</span>,</span>
<span>  <span class="st">"hspacousin"</span>, <span class="st">"hspaunt"</span>, <span class="st">"hspauntH"</span>,</span>
<span>  <span class="st">"puncle"</span>, <span class="st">"pgm"</span>, <span class="st">"pgf"</span>,</span>
<span>  <span class="st">"pucousin"</span>, <span class="st">"puncleW"</span>, <span class="st">"puncle"</span>,</span>
<span>  <span class="st">"maunt"</span>, <span class="st">"mgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"macousin"</span>, <span class="st">"maunt"</span>, <span class="st">"mauntH"</span>,</span>
<span>  <span class="st">"hsmuncle"</span>, <span class="st">"newmgm"</span>, <span class="st">"mgf"</span>,</span>
<span>  <span class="st">"hsmucousin"</span>, <span class="st">"hsmuncleW"</span>, <span class="st">"hsmuncle"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">thrs</span> <span class="op">=</span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span> id <span class="op">=</span> <span class="va">family</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span> lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span> upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="cn">Inf</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The object <code>family</code> is meant to represent the trio
information that can be found in registers. It is possible to have
multiple families in the same input data or single individuals with no
family links.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_graph.html">prepare_graph</a></span><span class="op">(</span>.tbl <span class="op">=</span> <span class="va">family</span>, </span>
<span>                      thresholds <span class="op">=</span> <span class="va">thrs</span>,</span>
<span>                      fcol <span class="op">=</span> <span class="st">"dadcol"</span>,</span>
<span>                      mcol <span class="op">=</span> <span class="st">"momcol"</span>,</span>
<span>                      icol <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">graph</span></span></code></pre></div>
<pre><code><span><span class="co">## IGRAPH 8439f2b DN-- 31 44 -- </span></span>
<span><span class="co">## + attr: name (v/c), lower (v/n), upper (v/n)</span></span>
<span><span class="co">## + edges from 8439f2b (vertex names):</span></span>
<span><span class="co">##  [1] dad     -&gt;pid        mom     -&gt;pid        dad     -&gt;sib       </span></span>
<span><span class="co">##  [4] mom     -&gt;sib        dad2    -&gt;mhs        mom     -&gt;mhs       </span></span>
<span><span class="co">##  [7] dad     -&gt;phs        mom2    -&gt;phs        mgf     -&gt;mom       </span></span>
<span><span class="co">## [10] mgm     -&gt;mom        pgf     -&gt;dad        pgm     -&gt;dad       </span></span>
<span><span class="co">## [13] pgf2    -&gt;dad2       pgm2    -&gt;dad2       pgf     -&gt;paunt     </span></span>
<span><span class="co">## [16] pgm     -&gt;paunt      pauntH  -&gt;pacousin   paunt   -&gt;pacousin  </span></span>
<span><span class="co">## [19] newpgf  -&gt;hspaunt    pgm     -&gt;hspaunt    hspauntH-&gt;hspacousin</span></span>
<span><span class="co">## [22] hspaunt -&gt;hspacousin pgf     -&gt;puncle     pgm     -&gt;puncle    </span></span>
<span><span class="co">## + ... omitted several edges</span></span></code></pre>
<p>The object <code>graph</code> is a directed graph constructed from
the trio information in <code>family</code> and is build using the
<strong><em>igraph</em></strong> package. The direction in the graph is
from parent to offspring.</p>
</div>
<div class="section level3">
<h3 id="from-graph-to-subgraph-and-kinship-matrix">From graph to subgraph and kinship matrix<a class="anchor" aria-label="anchor" href="#from-graph-to-subgraph-and-kinship-matrix"></a>
</h3>
<p>We can construct a kinship matrix from all family members present in
<code>family</code>, or we can consider only the family members that are
of degree <span class="math inline">\(n\)</span>. We can identify the
family members of degree <span class="math inline">\(2\)</span> like
this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make_ego_graph returns list, even for node input of length 1</span></span>
<span><span class="va">fam_graph</span> <span class="op">=</span> <span class="fu"><a href="https://r.igraph.org/reference/ego.html" class="external-link">make_ego_graph</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">graph</span>, </span>
<span>                           order <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                           nodes <span class="op">=</span> <span class="st">"pid"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fam_graph</span>, layout <span class="op">=</span> <span class="va">layout_as_tree</span>,</span>
<span>     vertex.size <span class="op">=</span> <span class="fl">27.5</span>,</span>
<span>     vertex.shape <span class="op">=</span> <span class="st">"rectangle"</span>,</span>
<span>     vertex.label.cex <span class="op">=</span> <span class="fl">.75</span>,</span>
<span>     edge.arrow.size <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="FromTrioToFamilies_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>In particular, individuals such as paternal uncle’s child (i.e a
cousin, coded as pucousin above) is not present with this relatedness
cut-off as such family members are of degree <span class="math inline">\(3\)</span>.</p>
<p>Finally, the kinship matrix can be calculated with
<code><a href="../reference/get_kinship.html">get_kinship()</a></code> (output made nicer with round) in the
following way:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the kinship matrix is multiplied by 100 and rounded for illustrative purposes!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_kinship.html">get_kinship</a></span><span class="op">(</span><span class="va">fam_graph</span>, h2 <span class="op">=</span> <span class="fl">1</span>, index_id <span class="op">=</span> <span class="st">"pid"</span>, add_ind <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        pid sib mhs phs mom dad paunt puncle maunt mgm pgm mgf pgf</span></span>
<span><span class="co">## pid    100  50  25  25  50  50    25     25    25  25  25  25  25</span></span>
<span><span class="co">## sib     50 100  25  25  50  50    25     25    25  25  25  25  25</span></span>
<span><span class="co">## mhs     25  25 100   0  50   0     0      0    25  25   0  25   0</span></span>
<span><span class="co">## phs     25  25   0 100   0  50    25     25     0   0  25   0  25</span></span>
<span><span class="co">## mom     50  50  50   0 100   0     0      0    50  50   0  50   0</span></span>
<span><span class="co">## dad     50  50   0  50   0 100    50     50     0   0  50   0  50</span></span>
<span><span class="co">## paunt   25  25   0  25   0  50   100     50     0   0  50   0  50</span></span>
<span><span class="co">## puncle  25  25   0  25   0  50    50    100     0   0  50   0  50</span></span>
<span><span class="co">## maunt   25  25  25   0  50   0     0      0   100  50   0  50   0</span></span>
<span><span class="co">## mgm     25  25  25   0  50   0     0      0    50 100   0   0   0</span></span>
<span><span class="co">## pgm     25  25   0  25   0  50    50     50     0   0 100   0   0</span></span>
<span><span class="co">## mgf     25  25  25   0  50   0     0      0    50   0   0 100   0</span></span>
<span><span class="co">## pgf     25  25   0  25   0  50    50     50     0   0   0   0 100</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emil Michael Pedersen, Florian Privé, Jette Steinbach.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
